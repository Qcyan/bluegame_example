{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 316cbc4c6777f23fcb95","webpack:///./src/util/index.js","webpack:///./src/core/engine/index.js","webpack:///./src/core/engine/res/index.js","webpack:///./src/core/base/index.js","webpack:///./src/core/engine/role/index.js","webpack:///./src/core/index.js","webpack:///./src/core/webpack-hot.js","webpack:///./src/core/instance/index.js","webpack:///./src/util/dom.js","webpack:///./src/core/storage/index.js","webpack:///./src/core/instance/methods.js","webpack:///./src/core/instance/init.js","webpack:///./src/core/engine/map/index.js","webpack:///./src/core/engine/map/methods.js","webpack:///./src/core/engine/res/methods.js","webpack:///./src/core/engine/skill/index.js","webpack:///./src/core/engine/skill/methods.js","webpack:///./src/core/engine/role/methods.js","webpack:///./src/core/engine/role/monster/index.js","webpack:///./src/core/engine/role/monster/methods.js","webpack:///./src/core/engine/npc/index.js","webpack:///./src/core/engine/npc/methods.js","webpack:///./src/core/engine/task/index.js","webpack:///./src/core/engine/task/methods.js","webpack:///./src/core/engine/res/equipment/index.js","webpack:///./src/core/engine/res/equipment/methods.js","webpack:///./src/core/engine/res/consumable/index.js","webpack:///./src/core/engine/res/consumable/methods.js","webpack:///./src/core/engine/res/strengthen/index.js","webpack:///./src/core/engine/res/strengthen/methods.js"],"names":["root","factory","exports","module","define","amd","self","this","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","util","Util","_classCallCheck","_possibleConstructorReturn","__proto__","getPrototypeOf","__WEBPACK_IMPORTED_MODULE_0__dom__","val","JSON","stringify","toString","Array","isPlainObject","isArray","undefined","trim","length","bool","context","callback","arguments","args","apply","obj","cb","isReturn","isUndef","index","newVal","len","push","key","value","_obj","deepCopy","_object","_this2","oldObjKeys","each","findIndexInOld","indexOf","splice","extend","expr","tmItem","replace","RegExp","__webpack_exports__","Engine","__WEBPACK_IMPORTED_MODULE_0__base__","uid","Res","opts","_this","$options","__WEBPACK_IMPORTED_MODULE_1__util__","__WEBPACK_IMPORTED_MODULE_0__methods__","$map","id","__WEBPACK_IMPORTED_MODULE_2__index__","Base","constructor","Role","__WEBPACK_IMPORTED_MODULE_0__util__","__WEBPACK_IMPORTED_MODULE_2__methods__","updateRoleProperty","updateResSpace","clearFight","__WEBPACK_IMPORTED_MODULE_1__index__","allRes","$game","getRes","roleRes","res","lists","_res","type","findSameRes","split","isGetCount","cheakcBinding","skillId","_this3","allSkills","getSkills","skill","level","skills","skillUid","allTasks","getTasks","tasks","task","taskId","monsterId","monsters","monster","count","game","gameResources","hooks","receiveTask","roleTasks","status","updateTaskStatus","cancelTask","reward","result","exp","currency","submitTask","equipment","roleEquipments","equipments","inBodyEquipment","classify","nullPlainObject","disboard","isEquip","equip","isCounterattack","use","consumable","amount","enemy","isDie","Monster","fight","current","isMonster","enemyHarm","proportion","attributes","hp","wasting","total","__WEBPACK_IMPORTED_MODULE_1__instance__","__WEBPACK_IMPORTED_MODULE_2__engine__","Map","__WEBPACK_IMPORTED_MODULE_3__engine_map__","Npc","__WEBPACK_IMPORTED_MODULE_8__engine_npc__","__WEBPACK_IMPORTED_MODULE_4__engine_res__","Skill","__WEBPACK_IMPORTED_MODULE_5__engine_skill__","__WEBPACK_IMPORTED_MODULE_6__engine_role__","__WEBPACK_IMPORTED_MODULE_7__engine_role_monster__","Equipment","__WEBPACK_IMPORTED_MODULE_10__engine_res_equipment__","Consumable","__WEBPACK_IMPORTED_MODULE_11__engine_res_consumable__","Strengthen","__WEBPACK_IMPORTED_MODULE_12__engine_res_strengthen__","Task","__WEBPACK_IMPORTED_MODULE_9__engine_task__","__WEBPACK_IMPORTED_MODULE_0__webpack_hot__","isInstance","gameInstance","BlueGame","__WEBPACK_IMPORTED_MODULE_1__base__","__WEBPACK_IMPORTED_MODULE_3__methods__","__WEBPACK_IMPORTED_MODULE_4__init__","mapId","my","role","maps","goMap","map","getMaps","allMaps","npcId","allNpcs","npcs","resId","allMonsters","vueInstance","$vm","allRoles","strengthen","rules","upgrade","ruleRes","rule","local","__WEBPACK_IMPORTED_MODULE_2__storage__","session","Dom","el","outerHTML","document","querySelector","tag","createElement","text","createTextNode","comment","createComment","textContent","parent","exEl","insertBefore","nextSibling","parentNode","remove","setAttribute","removeAttribute","Storage","storage","window","localStorage","getItem","setItem","removeItem","clear","config","roles","die","levelUp","hurt","attackIntrinsic","effect","defenseIntrinsic","Math","floor","random","inlay","notResSpace","Vue","currentMap","getNpcs","newTaskRes","details","gotRes","hasGain","gain","findLevelInStrengthen","isStrengthen","strengthenSort","keys","sort","j","parseInt","mapUid","npcUid","getMonsters","monsterUid","description","players","price","capacity","isBinding","__WEBPACK_IMPORTED_MODULE_1__methods__","time","timer","mp","physicalAttack","physicalDefense","magicAttack","magicDefense","consume","occupation","intrinsic","_intrinsic","gains","head","body","hand","foot","weapon","space","max","attr","gainItem","round","resetRoleProperty","roleTask","roleTaskRes","roleTaskMonsters","currentTask","resStatus","monsterStatus","findRoleRes","getTaskResCount","getTaskMonstersCount","npc","npcTasks","resetTaskStatus","taskStatus","hasTask","hasUnfinishedTask","hasResultTask","taskDetails","taskCount","set","taskRes","resRemove","goodsPrice","parseFloat","toFixed","resCapacity","_skill$consume","skillHp","skillMp","_this4","_skill$consume2","roleAttributes","skillStatus","attackName","skillAttributes","setGain","enemyAttributes","rolePhysicalAttack","roleSpellAttack","enemyPhysicalDefense","enemySpellDefense","attack","recover","_this5","consumableAttributes","_this6","strengthenRes","findStrengthenRes","_strengthenRes","quantity","findRes","forEach","updateEquipment","hasResSpace","randomNumber","Date","getTime","_count","checkBinding","roleAllRes","findGain","updateLevel","defense","enemyHp","monstersHook","roleHook","currentRole","updateReward","roleExp","diffExp","updateLevelUpExp","_property$attributes","currentRes","gainAttributes","findIndex","clearTimeout","newGain","setTimeout","bind","tasked","_tasks","prevTask","prevTasks","resUid","taskMonsters","notReceivedTask","unfinishedTask","resultTask","quality","_property","hasUse"],"mappings":"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","file":"js/blue-game-engine.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"BlueGame\"] = factory();\n\telse\n\t\troot[\"BlueGame\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"./static\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 316cbc4c6777f23fcb95","import Dom from './dom';\r\n\r\nclass Util extends Dom {\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  nullPlainObject(val){\r\n    return JSON.stringify(val) === \"{}\";\r\n  }\r\n\r\n  isStr(val) {\r\n    return typeof val === 'string';\r\n  }\r\n\r\n  isPlainObject(val) {\r\n    return val && val !== null && (val.toString() === '[object Object]');\r\n  }\r\n\r\n  isArray(val) {\r\n    return val instanceof Array;\r\n  }\r\n\r\n  isObjcet(val) {\r\n    return this.isPlainObject(val) || this.isArray(val);\r\n  }\r\n\r\n  isDef(val) {\r\n    return val !== undefined && val !== null;\r\n  }\r\n\r\n  isUndef(val) {\r\n    return val === undefined || val === null;\r\n  }\r\n\r\n  isBlankSpace(val) {\r\n    return val.trim().length === 0;\r\n  }\r\n\r\n  isTrue(bool) {\r\n    return bool === true;\r\n  }\r\n\r\n  isFalse(bool) {\r\n    return bool === false;\r\n  }\r\n\r\n  run(context, callback = function () {\r\n  }, args = []) {\r\n    callback.apply(context, args);\r\n  }\r\n\r\n  each(obj, cb, isReturn = false) {\r\n    if (this.isUndef(obj)) return;\r\n    let i = 0,\r\n      index = 0,\r\n      newVal = [];\r\n\r\n    const len = obj.length;\r\n\r\n    if (this.isArray(obj)) {\r\n      for (; i < len; i++) {\r\n        if (isReturn) {\r\n          newVal.push(cb(obj[i], i));\r\n        } else {\r\n          cb(obj[i], i);\r\n        }\r\n      }\r\n    } else {\r\n      for (i in obj) {\r\n        if (!obj.hasOwnProperty(i)) continue;\r\n        if (isReturn) {\r\n          newVal.push(cb(obj[i], i, index++));\r\n        } else {\r\n          cb(obj[i], i, index++);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (isReturn) return newVal;\r\n  }\r\n\r\n  definePropertyVal(obj, key, val) {\r\n    Object.defineProperty(obj, key, {\r\n      configurable: false,\r\n      enumerable: false,\r\n      value: val\r\n    });\r\n  }\r\n\r\n  deepCopy(obj) {\r\n    if (!obj || !(obj instanceof Array) && !(obj.toString() === \"[object Object]\")) return obj;\r\n    const _obj = obj instanceof Array ? [] : {};\r\n    for (let key in obj) {\r\n      if (!obj.hasOwnProperty(key)) continue;\r\n      if ((obj instanceof Array) || (obj instanceof Object)) {\r\n        _obj[key] = this.deepCopy(obj[key]);\r\n      } else {\r\n        _obj[key] = obj[key];\r\n      }\r\n    }\r\n    return _obj;\r\n  }\r\n\r\n  extend(object, _object) {\r\n\r\n    object = this.deepCopy(object);\r\n\r\n    const oldObjKeys = this.each(object, (obj, key) => {\r\n      return key;\r\n    }, true);\r\n\r\n    this.each(_object, (obj, key) => {\r\n\r\n      const findIndexInOld = oldObjKeys.indexOf(key);\r\n      if (findIndexInOld != -1) {\r\n        oldObjKeys.splice(findIndexInOld, 1);\r\n      }\r\n\r\n      if (this.isPlainObject(obj)) {\r\n        if (!object[key]) {\r\n          object[key] = {};\r\n        }\r\n        this.extend(object[key], obj);\r\n      }\r\n      object[key] = obj;\r\n    });\r\n\r\n    this.each(oldObjKeys, (key) => {\r\n      _object[key] = object[key];\r\n    });\r\n\r\n    return object;\r\n  }\r\n\r\n  //把当前key-value复制到对应对象的key-value上\r\n  copy(object, _object) {\r\n    util.each(_object, (obj, key) => {\r\n      object[key] = obj;\r\n    });\r\n  }\r\n\r\n  //获取表达式\r\n  getRegExp(expr) {\r\n    const tm = '\\\\/*.?+$^[](){}|\\'\\\"';\r\n    this.each(tm, (tmItem, index) => {\r\n      expr = expr.replace(new RegExp('\\\\' + tmItem, 'g'), '\\\\' + tmItem);\r\n    });\r\n    return expr;\r\n  }\r\n\r\n  getObjLen(obj) {\r\n    let index = 0;\r\n    this.each(obj,()=>{\r\n      ++index;\r\n    });\r\n    return index;\r\n  }\r\n}\r\n\r\nconst util = new Util();\r\n\r\n\r\nexport default util;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/index.js","import Base from '../base';\r\n\r\nclass Engine extends Base{\r\n  constructor(){\r\n    super();\r\n  }\r\n}\r\n\r\nexport default Engine;\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/engine/index.js","/*\r\n* 物资类\r\n* */\r\nimport { getConfig } from './methods';\r\nimport util from '@util';\r\nimport Engine from '../index';\r\n\r\nlet uid = 1;\r\n\r\nclass Res extends Engine {\r\n  constructor(opts = {}) {\r\n    super();\r\n    this.$options = util.extend(getConfig(), opts);\r\n    init.call(this);\r\n  }\r\n}\r\n\r\nfunction init() {\r\n  this.$map(this, this.$options);\r\n  this.id = (this.id || uid++);\r\n  delete this.$options;\r\n}\r\n\r\nexport default Res;\n\n\n// WEBPACK FOOTER //\n// ./src/core/engine/res/index.js","class Base {\r\n  $property(constructor, name, property) {\r\n    constructor[name] = property;\r\n  }\r\n\r\n  $map(object, _object) {\r\n    for (let key in _object) {\r\n      if (!_object.hasOwnProperty(key)) continue;\r\n      object[key] = _object[key];\r\n    }\r\n  }\r\n};\r\n\r\nexport default Base;\n\n\n// WEBPACK FOOTER //\n// ./src/core/base/index.js","/*\r\n* npc类\r\n* */\r\n\r\nimport util from '@util';\r\nimport Engine from '../index';\r\nimport {\r\n  getConfig,\r\n  updateRoleProperty,\r\n  updateTaskStatus,\r\n  receiveTask,\r\n  updateReward,\r\n  updateResSpace,\r\n  removeRoleTaskRes,\r\n  isAdequateSkillConsume,\r\n  findSameRes,\r\n  buy,\r\n  useSkill,\r\n  hasResSpace,\r\n  useConsumable,\r\n  strengthen\r\n} from './methods';\r\n\r\nclass Role extends Engine {\r\n  constructor(opts = {}) {\r\n    super();\r\n    this.$options = util.extend(getConfig(), opts);\r\n    init.call(this);\r\n  }\r\n\r\n  //获取资源\r\n  getRes(id) {\r\n\r\n    const game = this.$game,\r\n      allRes = game.getRes(),\r\n      roleRes = this.res.lists;\r\n\r\n    /* 根据具体的id查询自身的资源 */\r\n    if (id) {\r\n      for (let i = 0; i < roleRes.length; i++) {\r\n\r\n        const res = roleRes[i],\r\n          _res = allRes[id];\r\n\r\n        //是需要查询的资源\r\n        if (!(res.id === id)) continue;\r\n\r\n        //装备直接返回背包的属性\r\n        if (res.type === 2) {\r\n          return {\r\n            res,\r\n            roleRes: res\r\n          };\r\n        } else {\r\n          //资源则返回物品类\r\n          return {\r\n            res: _res,\r\n            roleRes: this.findSameRes(res)\r\n          };\r\n        }\r\n      }\r\n\r\n      return {\r\n        res: null,\r\n        roleRes: {}\r\n      };\r\n    }\r\n\r\n    return util.each(roleRes, (_res, i) => {\r\n\r\n      let id = _res.id.toString().split('-')[0];\r\n\r\n      const res = allRes[id];\r\n\r\n      if (res.type === 2) {\r\n        return this.getRes(_res.id);\r\n      } else {\r\n        return {\r\n          res,\r\n          roleRes: _res     //用户具体的数据 {id:1,count:1}\r\n        };\r\n      }\r\n    }, true);\r\n  }\r\n\r\n  findSameRes(res, isGetCount, cheakcBinding) {\r\n    return findSameRes.apply(this, [res, isGetCount, cheakcBinding]);\r\n  }\r\n\r\n  //获取玩家的技能\r\n  getSkills(skillId) {\r\n    const allSkills = this.$game.getSkills();\r\n    if (skillId) {\r\n      const skill = allSkills[skillId];\r\n      if (skill && skill.level <= this.property.level) {\r\n        return skill;\r\n      }\r\n      return {};\r\n    }\r\n    const skills = [];\r\n    util.each(this.skills, (skillUid) => {\r\n      const skill = allSkills[skillUid];\r\n      if (!skill || skill.level > this.property.level) return;\r\n      skills.push(skill);\r\n    });\r\n    return skills;\r\n  }\r\n\r\n  //获取任务当前的任务\r\n  getTasks() {\r\n    const allTasks = this.$game.getTasks();\r\n    return util.each(this.tasks.lists, (task, taskId) => {\r\n      return allTasks[taskId];\r\n    }, true);\r\n  }\r\n\r\n  //获取指定任务中怪物的数量\r\n  getTaskMonstersCount(id, monsterId) {\r\n    const task = this.tasks.lists[id];\r\n    if (!task) return 0;\r\n    const monsters = task.monsters;\r\n    for (let i = 0; i < monsters.length; i++) {\r\n      const monster = monsters[i];\r\n      if (monsterId == monster.id) {\r\n        return monster.count;\r\n      }\r\n    }\r\n  }\r\n\r\n  //更新角色当前的任务状态，击杀怪物后（获得物品），获取资源调用更新\r\n  updateTaskStatus(opts = { monsterId: 0 }) {\r\n    updateTaskStatus.call(this, opts);\r\n  }\r\n\r\n  //接受任务\r\n  receiveTask(task) {\r\n    const game = this.$game;\r\n    receiveTask.call(this, task);\r\n    //@hooks submitTask\r\n    game.gameResources.tasks.hooks.receiveTask.call(game, { task });\r\n    return this;\r\n  }\r\n\r\n  //取消任务\r\n  cancelTask(task) {\r\n    const roleTasks = this.tasks.lists,\r\n      game = this.$game;\r\n    if (!roleTasks[task.id]) return false;\r\n    delete roleTasks[task.id];\r\n    task.status = 0;\r\n    this.updateTaskStatus();\r\n    //@hooks submitTask\r\n    game.gameResources.tasks.hooks.cancelTask.call(game, { task });\r\n  }\r\n\r\n  //提交任务\r\n  submitTask(task) {\r\n    if (!(task.status === 2)) return false;\r\n    const reward = task.reward,\r\n      game = this.$game;\r\n    task.status = 3;\r\n    removeRoleTaskRes.call(this, task);\r\n    this.tasks.result.push(task.id);\r\n    delete this.tasks.lists[task.id];\r\n    updateReward.apply(this, [reward.exp, reward.currency, reward.res]);\r\n    this.updateTaskStatus();\r\n\r\n    //@hooks submitTask\r\n    game.gameResources.tasks.hooks.submitTask.call(game, { task });\r\n  }\r\n\r\n  //更新玩家的属性特性\r\n  updateRoleProperty() {\r\n    updateRoleProperty.call(this);\r\n  }\r\n\r\n  //穿上装备\r\n  equip(equipment) {\r\n\r\n    /* 没有背包空间 */\r\n    if (!hasResSpace.call(this)) {\r\n      return false;\r\n    }\r\n\r\n    const roleRes = this.res.lists,\r\n      game = this.$game,\r\n      roleEquipments = this.equipments,\r\n      inBodyEquipment = roleEquipments[equipment.classify];\r\n\r\n    //假的装备吧?\r\n    if (!equipment.classify && equipment.type !== 2) return false;\r\n\r\n    //身上是否穿了衣服，脱下\r\n    if (!util.nullPlainObject(inBodyEquipment)) {\r\n      this.disboard(inBodyEquipment);\r\n    }\r\n\r\n    //穿到指定的位置上\r\n    roleEquipments[equipment.classify] = equipment;\r\n\r\n    //获取到装备在背包上具体的位置\r\n    const index = roleRes.indexOf(equipment);\r\n\r\n    //从背包中移除\r\n    roleRes.splice(index, 1);\r\n\r\n    //更新穿戴状态\r\n    equipment.isEquip = true;\r\n\r\n    this.updateRoleProperty();\r\n\r\n    this.updateResSpace();\r\n\r\n    //@hooks use res\r\n    game.gameResources.res.hooks.equip.call(game, { res: equipment });\r\n\r\n    return true;\r\n  }\r\n\r\n  //卸下装备\r\n  disboard(equipment) {\r\n    const game = this.$game;\r\n\r\n    /* 没有背包空间 */\r\n    if (!hasResSpace.call(this)) {\r\n      return false;\r\n    }\r\n\r\n    //清空装备状态\r\n    this.equipments[equipment.classify] = {};\r\n\r\n    /* 放回到背包 */\r\n    this.res.lists.push(equipment);\r\n\r\n    equipment.isEquip = false;\r\n\r\n    this.updateRoleProperty();\r\n\r\n    this.updateResSpace();\r\n\r\n    //@hooks use res\r\n    game.gameResources.res.hooks.disboard.call(game, { res: equipment });\r\n\r\n    return true;\r\n  }\r\n\r\n  //使用技能\r\n  skill(skill, isCounterattack = true) {\r\n    const game = skill.$game;\r\n    //检测是否够hp和mp的扣除\r\n    if (isAdequateSkillConsume.call(this, skill)) {\r\n      useSkill.apply(this, [skill, isCounterattack]);\r\n\r\n      this.updateRoleProperty();\r\n\r\n      //@hook skill\r\n      game.gameResources.skills.hooks.use.call(game, { skill })\r\n\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  //使用消耗品\r\n  consumable(roleRes) {\r\n    const game = this.$game;\r\n\r\n    let status = useConsumable.call(this, roleRes);\r\n\r\n    this.updateRoleProperty();\r\n\r\n    this.updateTaskStatus();\r\n\r\n    this.updateResSpace();\r\n\r\n    //@hooks use res\r\n    game.gameResources.res.hooks.consumable.call(game, { res: roleRes });\r\n\r\n    return status;\r\n  }\r\n\r\n  //更新背包空间\r\n  updateResSpace() {\r\n    updateResSpace.call(this);\r\n  }\r\n\r\n  //购买物品\r\n  buy(res, amount) {\r\n    if (!hasResSpace.call(this)) return false;\r\n\r\n    buy.apply(this, [res, amount]);\r\n\r\n    this.updateTaskStatus();\r\n\r\n    this.updateResSpace();\r\n\r\n    return true;\r\n  }\r\n\r\n  //丢弃物品\r\n  discard(res, amount) {\r\n    const roleRes = this.res.lists,\r\n      index = roleRes.indexOf(res);\r\n    if (res.type === 2) {\r\n      roleRes.splice(index, 1);\r\n    } else {\r\n      res.count -= amount;\r\n      if (res.count < 1) {\r\n        roleRes.splice(index, 1);\r\n      }\r\n    }\r\n    this.updateResSpace();\r\n  }\r\n\r\n  //强化装备\r\n  strengthen(equipment) {\r\n    return strengthen.call(this, equipment);\r\n  }\r\n\r\n  //进入战斗场景\r\n  fight(enemy) {\r\n\r\n    //如果角色已经死亡了，不能再进行战斗了\r\n    if (this.isDie) return false;\r\n\r\n    const Engine = this.$game.constructor.Engine;\r\n\r\n    const { Monster } = Engine,\r\n      current = this.current,\r\n      fight = current.fight;\r\n\r\n    //攻击对象为怪物\r\n    if (enemy && enemy.isMonster) {\r\n\r\n      //设置自己击杀的对象\r\n      fight.enemy = new Monster(util.deepCopy(enemy));\r\n\r\n      fight.enemyHarm = 0;\r\n\r\n      //怪物的对手是自己\r\n      fight.enemy.current.fight.enemy = this;\r\n\r\n      fight.enemy.current.fight.enemyHarm = 0;\r\n\r\n      //更新一下怪物的属性\r\n      fight.enemy.updateRoleProperty();\r\n\r\n    } else if (enemy && !enemy.isMonster) {\r\n      //攻击对象为玩家\r\n      fight.enemy = enemy;\r\n      enemy.updateRoleProperty();\r\n    }\r\n  }\r\n\r\n  //清除战斗场景\r\n  clearFight() {\r\n    const fight = this.current.fight;\r\n    fight.enemy = null;\r\n    fight.enemyHarm = 0;\r\n  }\r\n\r\n  //恢复体力\r\n  //@proportion {Number} 0-1 恢复的比例\r\n  dieRecover(proportion) {\r\n    const attributes = this.property.attributes;\r\n    attributes.hp.wasting = -(attributes.hp.total * (1 - proportion));\r\n    this.updateRoleProperty();\r\n  }\r\n}\r\n\r\nfunction init() {\r\n\r\n  this.$map(this, this.$options);\r\n\r\n  delete this.$options;\r\n\r\n  this.updateRoleProperty();\r\n\r\n  this.updateResSpace();\r\n\r\n  this.clearFight();\r\n\r\n}\r\n\r\nexport default Role;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/engine/role/index.js","import webpackHot from './webpack-hot';\r\n\r\n/*Game and ENGINE*/\r\nimport BlueGame from './instance';\r\nimport Engine from \"./engine\";\r\n\r\n/*game constructor*/\r\nimport Map from './engine/map';\r\nimport Res from './engine/res';\r\nimport Skill from './engine/skill';\r\nimport Role from './engine/role';\r\nimport Monster from './engine/role/monster';\r\nimport Npc from './engine/npc';\r\nimport Task from './engine/task';\r\nimport Equipment from './engine/res/equipment';\r\nimport Consumable from \"./engine/res/consumable\";\r\nimport Strengthen from \"./engine/res/strengthen\";\r\n\r\n/*GAME Static -> ENGINE*/\r\nBlueGame.Engine = Engine;\r\n\r\n/*ENGINE static methods class -> Map,Npc,Res,Skill,Role,Monster,Equipment,Consumable,Task*/\r\nEngine.Map = Map;\r\nEngine.Npc = Npc;\r\nEngine.Res = Res;\r\nEngine.Skill = Skill;\r\nEngine.Role = Role;\r\nEngine.Monster = Monster;\r\nEngine.Equipment = Equipment;\r\nEngine.Consumable = Consumable;\r\nEngine.Strengthen = Strengthen;\r\nEngine.Task = Task;\r\n\r\n/*webpack hot*/\r\nwebpackHot();\r\n\r\nexport default BlueGame;\n\n\n// WEBPACK FOOTER //\n// ./src/core/index.js","export default function hot() {\r\n  if (process.env == 'development' && process.dev) {\r\n    if (module.hot) {\r\n      module.hot.accept();\r\n    }\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/webpack-hot.js","//main\r\nimport util from '@util';\r\nimport Base from '../base';\r\nimport Storage from '../storage';\r\nimport {\r\n  getConfig,\r\n  updateCurrentMap,\r\n  updateCurrentNpcs\r\n} from './methods';\r\n\r\nimport {\r\n  initRes,\r\n  initMy,\r\n  initSkillsGain,\r\n  initStrengthen,\r\n  filterTaskHasEquipment\r\n} from './init';\r\n\r\nlet isInstance = false;\r\n\r\nlet gameInstance = null;\r\n\r\nclass BlueGame extends Base {\r\n  constructor(opts = {}) {\r\n    super();\r\n    if (this.constructor !== BlueGame) {\r\n      return new BlueGame(opts);\r\n    } else if (isInstance) {\r\n      return gameInstance;\r\n    }\r\n    isInstance = true;\r\n    gameInstance = this;\r\n    init.call(this, opts);\r\n  }\r\n\r\n  //go map\r\n  goMap(mapId) {\r\n\r\n    //update current map\r\n    updateCurrentMap.call(this, mapId);\r\n\r\n    //update current map has npcs\r\n    updateCurrentNpcs.call(this);\r\n\r\n    //update all tasks status\r\n    if (this.my.role) this.my.role.updateTaskStatus();\r\n\r\n    //@hooks go map\r\n    this.gameResources.maps.hooks.goMap.call(this, { map: this.getMaps()[mapId] });\r\n  }\r\n\r\n  //get id in map or all map\r\n  getMaps(mapId) {\r\n    const allMaps = this.gameResources.maps.lists;\r\n    if (mapId) {\r\n      return allMaps[mapId] || null;\r\n    }\r\n    return allMaps;\r\n  }\r\n\r\n  //get id in npc or all npcs\r\n  getNpcs(npcId) {\r\n    const allNpcs = this.gameResources.npcs.lists;\r\n    if (npcId) {\r\n      return allNpcs[allNpcs] || null;\r\n    }\r\n    return allNpcs;\r\n  }\r\n\r\n  //get id in res or all res\r\n  getRes(resId) {\r\n    const allRes = this.gameResources.res.lists;\r\n    if (resId) {\r\n      return allRes[resId] || null;\r\n    }\r\n    return allRes;\r\n  }\r\n\r\n  //get id in tasks or all tasks\r\n  getTasks(taskId) {\r\n    const allTasks = this.gameResources.tasks.lists;\r\n    if (taskId) {\r\n      return allTasks[taskId] || null;\r\n    }\r\n    return allTasks;\r\n  }\r\n\r\n  //get id in tasks or all tasks\r\n  getSkills(skillId) {\r\n    const allSkills = this.gameResources.skills.lists;\r\n    if (skillId) {\r\n      return allSkills[skillId] || null;\r\n    }\r\n    return allSkills;\r\n  }\r\n\r\n  //get game monster in id\r\n  getMonsters(monsterId) {\r\n    const allMonsters = this.gameResources.monsters.lists;\r\n    if (monsterId) {\r\n      return allMonsters[monsterId] || null;\r\n    }\r\n    return allMonsters;\r\n  }\r\n\r\n  //set vm in game\r\n  setVueInstance(vueInstance) {\r\n    this.$vm = vueInstance;\r\n  }\r\n\r\n  // add role in game.my.allRoles\r\n  addMyRole(role) {\r\n    this.my.allRoles.push(role);\r\n  }\r\n\r\n  //set current role\r\n  setCurrentRole(role) {\r\n    this.my.role = role;\r\n  }\r\n\r\n  //find equipment strengthen the res\r\n  findStrengthenRes(equipment) {\r\n    const strengthen = equipment.strengthen;\r\n    const gameRes = this.gameResources.res,\r\n      rules = gameRes.upgrade.strengthen.rules,\r\n      ruleRes = [];\r\n\r\n    for (let i = 0; i < rules.length; i++) {\r\n      const rule = rules[i];\r\n      if (rule.strengthen > strengthen) {\r\n        ruleRes.push(rule.res);\r\n      }\r\n    }\r\n    return ruleRes[ruleRes.length - 1] || [];\r\n  }\r\n}\r\n\r\n/*storage methods in Game*/\r\nBlueGame.local = BlueGame.prototype.local = new Storage({ type: 'local' });\r\n\r\nBlueGame.session = BlueGame.prototype.session = new Storage({ type: 'session' });\r\n\r\nfunction init(opts) {\r\n\r\n  //mount $game attribute in base prototype\r\n  Object.defineProperty(Base.prototype, '$game', {\r\n    enumerable: false,\r\n    value: this\r\n  });\r\n\r\n  this.$options = util.extend(getConfig(), opts);\r\n\r\n  //init engine res\r\n  initRes.call(this);\r\n\r\n  //filter task has equipment\r\n  filterTaskHasEquipment.call(this);\r\n\r\n  //init all skills has gain status\r\n  initSkillsGain.call(this);\r\n\r\n  //init strengthen res in game\r\n  initStrengthen.call(this);\r\n\r\n  //init role state\r\n  initMy.call(this);\r\n\r\n  delete this.$options;\r\n}\r\n\r\nexport default BlueGame;\n\n\n// WEBPACK FOOTER //\n// ./src/core/instance/index.js","export default class Dom {\r\n  outerHTML(el) {\r\n    return el.outerHTML;\r\n  }\r\n\r\n  getElm(el) {\r\n    return document.querySelector(el);\r\n  }\r\n\r\n  createElement(tag) {\r\n    return document.createElement(tag);\r\n  }\r\n\r\n  createTextNode(text) {\r\n    return document.createTextNode(text);\r\n  }\r\n\r\n  createComment(comment) {\r\n    return document.createComment(comment);\r\n  }\r\n\r\n  textContent(el, textContent) {\r\n    el.textContent = textContent;\r\n  }\r\n\r\n  insertBefore(parent, el, exEl) {\r\n    parent.insertBefore(el, exEl);\r\n  }\r\n\r\n  nextSibling(el){\r\n    return el.nextSibling;\r\n  }\r\n\r\n  parent(el) {\r\n    return (el && el.parentNode) || null;\r\n  }\r\n\r\n  remove(el) {\r\n    el.remove();\r\n  }\r\n\r\n  setAttribute(el, name, value) {\r\n    el.setAttribute(name, value);\r\n  }\r\n\r\n  removeAttribute(el, name) {\r\n    el.removeAttribute(name);\r\n  }\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/dom.js","/*\r\n* storage数据存储\r\n* */\r\n\r\nclass Storage {\r\n  constructor(opts) {\r\n    this.$options = opts;\r\n    init.call(this);\r\n  }\r\n\r\n  getItem(key) {\r\n    return this.storage.getItem(key);\r\n  }\r\n\r\n  setItem(key, val) {\r\n    this.storage.setItem(key, val);\r\n    return this;\r\n  }\r\n\r\n  removeItem(key) {\r\n    this.storage.removeItem(key);\r\n    return this;\r\n  }\r\n\r\n  key(key) {\r\n    return this.storage.key(key);\r\n  }\r\n\r\n  clear() {\r\n    this.storage.clear();\r\n  }\r\n\r\n}\r\n\r\nfunction init() {\r\n  const { type } = this.$options;\r\n  this.storage = window[`${type}Storage`] || localStorage;\r\n}\r\n\r\nexport default Storage;\n\n\n// WEBPACK FOOTER //\n// ./src/core/storage/index.js","/*\r\n* main methods\r\n* */\r\n\r\n//get game config\r\nexport function getConfig() {\r\n  return {\r\n    config: {},\r\n    current: {\r\n      map: null,\r\n      npcs: []\r\n    },\r\n    my: {     //当前选择的角色\r\n      role: null,\r\n      allRoles: [],\r\n      hooks: {}\r\n    },\r\n    gameResources: {\r\n      roles: {    //多个角色\r\n        lists: [],\r\n        hooks: {\r\n          //role is die\r\n          die(opts) {\r\n          },\r\n          //level up hooks\r\n          levelUp() {\r\n          }\r\n        }\r\n      },\r\n      monsters: {\r\n        lists: {},\r\n        hooks: {\r\n          //野怪被击杀\r\n          die(opts) {\r\n          }\r\n        }\r\n      },\r\n      maps: {\r\n        lists: {},\r\n        hooks: {\r\n          goMap(opts) {\r\n            //go map hooks\r\n          }\r\n        }\r\n      },\r\n      skills: {\r\n        lists: {},\r\n        hooks: {\r\n          //fight hurt\r\n          hurt(attackIntrinsic, effect, defenseIntrinsic) {\r\n            return Math.floor((attackIntrinsic + (attackIntrinsic * effect)) - ((Math.random() * 1) * defenseIntrinsic + defenseIntrinsic))\r\n          },\r\n          use(opts) {\r\n\r\n          }\r\n        }\r\n      },\r\n      npcs: {\r\n        lists: {},\r\n        hooks: {}\r\n      },\r\n      res: {\r\n        lists: {},\r\n        upgrade: {          //提升\r\n          strengthen: {     //强化装备\r\n            rules: []\r\n          },\r\n          inlay: {}         //镶嵌宝石\r\n        },\r\n        hooks: {\r\n          equip(opts) {\r\n          },\r\n          disboard(opts) {\r\n          },\r\n          consumable(opts) {\r\n          },\r\n          notResSpace(opts) {\r\n          }\r\n        }\r\n      },\r\n      tasks: {\r\n        lists: {},\r\n        hooks: {\r\n          receiveTask(opts) {\r\n          },\r\n          cancelTask(opts) {\r\n          },\r\n          submitTask(opts) {\r\n          }\r\n        }\r\n      }\r\n    },\r\n    Vue: null,    //Vue构造\r\n    $vm: null   //vue实例\r\n  }\r\n}\r\n\r\n//update role in map\r\nexport function updateCurrentMap(mapId) {\r\n  this.current.map = this.gameResources.maps.lists[mapId || 1];\r\n  if (this.my.role) {\r\n    this.my.role.current.map = mapId || 1;\r\n  }\r\n}\r\n\r\n//update map has npcs\r\nexport function updateCurrentNpcs() {\r\n  const current = this.current,\r\n    currentMap = current.map;\r\n  current.npcs = currentMap ? current.map.getNpcs() : [];\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/instance/methods.js","import util from '@util';\r\n\r\n//init game res\r\nexport function initRes() {\r\n  //base.prototype.$map\r\n  this.$map(this, this.$options);\r\n}\r\n\r\n//init task has res in task detail,del res type === 2 data\r\nexport function filterTaskHasEquipment() {\r\n  const opts = this.$options;\r\n  util.each(opts.gameResources.tasks.lists, (task) => {\r\n    const newTaskRes = [];\r\n    for (let i = 0; i < task.details.res.length; i++) {\r\n      const res = task.details.res[i];\r\n      const gotRes = this.getRes(res.id);\r\n      if (gotRes.type !== 2) {\r\n        newTaskRes.push(res);\r\n      }\r\n    }\r\n    task.details.res = newTaskRes;\r\n  });\r\n}\r\n\r\n//init my role data\r\nexport function initMy() {\r\n  const Role = this.constructor.Engine.Role,\r\n    opts = this.$options;\r\n  this.my.role = opts.my.role ? new Role(opts.my.role) : null;\r\n}\r\n\r\n//init skills has gain status\r\nexport function initSkillsGain() {\r\n  util.each(this.gameResources.skills.lists, (skill) => {\r\n    util.each(skill.property, (property) => {\r\n      if (skill.hasGain) return;\r\n      if (property.gain !== 0) {\r\n        skill.hasGain = true;\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\n//init strengthen res in game\r\nexport function initStrengthen() {\r\n  const allRes = this.getRes(),\r\n    findLevelInStrengthen = {},\r\n    rules = [],\r\n    strengthen = this.gameResources.res.upgrade.strengthen;\r\n\r\n  util.each(allRes, (res) => {\r\n    if (!res.isStrengthen) return;\r\n    const strengthen = res.strengthen;\r\n    if (!findLevelInStrengthen[strengthen]) {\r\n      findLevelInStrengthen[strengthen] = [];\r\n    }\r\n    findLevelInStrengthen[strengthen].push(res);\r\n  });\r\n\r\n  const strengthenSort = Object.keys(findLevelInStrengthen).sort((i, j) => {\r\n    return i > j;\r\n  });\r\n\r\n  util.each(strengthenSort, (strengthen) => {\r\n    const res = findLevelInStrengthen[strengthen];\r\n    rules.push({\r\n      strengthen: parseInt(strengthen),\r\n      res\r\n    });\r\n  });\r\n\r\n  strengthen.rules = rules;\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/instance/init.js","/*\r\n* 地图类\r\n* */\r\n\r\nimport { getConfig } from './methods';\r\nimport util from '@util';\r\nimport Engine from '../index';\r\n\r\nlet uid = 1;\r\n\r\nclass Map extends Engine {\r\n  constructor(opts = {}) {\r\n    super();\r\n    this.$options = util.extend(getConfig(), opts);\r\n    init.call(this);\r\n  }\r\n\r\n  //获取当前所有的地图\r\n  getMaps() {\r\n    const allMaps = this.$game.getMaps();\r\n    return util.each(this.maps, (mapUid) => {\r\n      return allMaps[mapUid];\r\n    }, true);\r\n  }\r\n\r\n  //获取当前的npc\r\n  getNpcs() {\r\n    const allNpcs = this.$game.getNpcs();\r\n    return util.each(this.npcs, (npcUid) => {\r\n      return allNpcs[npcUid];\r\n    }, true);\r\n  }\r\n\r\n  getMonsters() {\r\n    const allMonsters = this.$game.getMonsters();\r\n    return util.each(this.monsters, (monsterUid) => {\r\n      return allMonsters[monsterUid];\r\n    }, true);\r\n  }\r\n\r\n}\r\n\r\nfunction init() {\r\n  this.$map(this, this.$options);\r\n  this.id = (this.id || uid++);\r\n  delete this.$options;\r\n}\r\n\r\nexport default Map;\n\n\n// WEBPACK FOOTER //\n// ./src/core/engine/map/index.js","export function getConfig() {\r\n  return {\r\n    name: '',         //地图名称\r\n    description: '',  //地图描述\r\n    players: [],        //玩家,\r\n    npcs: [],           //地图npc\r\n    maps: [],         //分支地点\r\n    monsters: []      //分配的怪物\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/engine/map/methods.js","/*\r\n* 物资方法\r\n* 物品类型 type {Number} 1:普通/材料类 2:装备 3:药品\r\n*\r\n* */\r\n\r\nexport function getConfig() {\r\n  return {\r\n    name: '',           //物品名字\r\n    description: '',    //物品描述\r\n    // isTrade: true,      //是否支持交易,暂时不做\r\n    type: 1,\r\n    price: 0,            //售价\r\n    capacity: 99,           //针对的背包中一个容量最大的限制数量\r\n    isBinding: false      //是否绑定\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/engine/res/methods.js","/*\r\n* 技能 类\r\n* */\r\n\r\nimport util from '@util';\r\nimport { getConfig } from './methods';\r\nimport Engine from '../index';\r\n\r\nlet uid = 1;\r\n\r\nclass Skill extends Engine {\r\n  constructor(opts) {\r\n    super();\r\n    this.$options = util.extend(getConfig(), opts);\r\n    init.call(this);\r\n  }\r\n}\r\n\r\nfunction init() {\r\n  this.$map(this, this.$options);\r\n  this.id = (this.id || uid++);\r\n  delete this.$options;\r\n}\r\n\r\nexport default Skill;\n\n\n// WEBPACK FOOTER //\n// ./src/core/engine/skill/index.js","/*\r\n* npc方法\r\n* */\r\n\r\n/*\r\n* @property 技能的特性\r\n* */\r\nexport function getConfig() {\r\n  return {\r\n    name: '',\r\n    description: '',\r\n    level: 1,     //等级限制\r\n    hasGain: false,   //是否存在增益效果\r\n    property: {\r\n      hp: {\r\n        gain: 0,      //增益\r\n        effect: 0,    //效果\r\n        time: null,   //增益的有限时间\r\n        timer: null   //增益的定时器\r\n      },\r\n      mp: {\r\n        gain: 0,\r\n        effect: 0,\r\n        time: null,\r\n        timer: null\r\n      },\r\n      physicalAttack: {\r\n        gain: 0,\r\n        effect: 0,\r\n        time: null,\r\n        timer: null\r\n      },\r\n      physicalDefense: {\r\n        gain: 0,\r\n        time: null,\r\n        timer: null\r\n      },\r\n      magicAttack: {\r\n        gain: 0,\r\n        effect: 0,\r\n        time: null,\r\n        timer: null\r\n      },\r\n      magicDefense: {\r\n        gain: 0,\r\n        time: null,\r\n        timer: null\r\n      }\r\n    },\r\n    consume: {    //消耗\r\n      hp: 0,\r\n      mp: 0\r\n    }\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/engine/skill/methods.js","/*\r\n* role methods\r\n* */\r\n\r\nimport util from '@util';\r\n\r\n//任务配置信息\r\nexport function getConfig() {\r\n  return {\r\n    id: 0,\r\n    name: '',                 //玩家名字\r\n    type: 0,                 //角色的类型\r\n    occupation: '',           //职业名，和角色类型挂钩的\r\n    /*---- 当前的场景 ----*/\r\n    current: {\r\n      /*---- 战斗场景 -----*/\r\n      fight: {\r\n        enemy: null,      //敌人\r\n        enemyHarm: 0     //敌人受到的伤害\r\n      },\r\n      map: null\r\n    },\r\n\r\n    /*---- 角色属性 -----*/\r\n    property: {\r\n\r\n      /*---- 经验 ----*/\r\n      exp: {\r\n        levelUp: 150,\r\n        current: 0\r\n      },\r\n\r\n      /*---- 玩家固有的 物理 法术 || 攻击 防御 ----*/\r\n      attributes: {\r\n\r\n        /*---- 血量 ----*/\r\n        hp: {\r\n          intrinsic: 120,       //原有的值\r\n          _intrinsic: 0,        //计算后的值\r\n          total: 0,              //总共\r\n          wasting: 0,            //消耗的\r\n          gains: []                //临时的效果\r\n        },\r\n\r\n        /*---- 魔法 ----*/\r\n        mp: {\r\n          intrinsic: 72,\r\n          _intrinsic: 0,\r\n          total: 0,\r\n          wasting: 0,\r\n          gains: []\r\n        },\r\n\r\n        physicalAttack: {\r\n          intrinsic: 30,\r\n          _intrinsic: 0,\r\n          gains: [],\r\n        },\r\n\r\n        physicalDefense: {\r\n          intrinsic: 15,\r\n          _intrinsic: 0,\r\n          gains: [],\r\n        },\r\n\r\n        magicAttack: {\r\n          intrinsic: 20,\r\n          _intrinsic: 0,\r\n          gains: [],\r\n        },\r\n\r\n        magicDefense: {\r\n          intrinsic: 20,\r\n          _intrinsic: 0,\r\n          gains: []\r\n        }\r\n      },\r\n\r\n      /*---- 资产 ----*/\r\n      currency: 0,\r\n\r\n      /*---- 等级 ----*/\r\n      level: 1\r\n    },\r\n\r\n    /*---- 玩家描述 ----*/\r\n    description: '',\r\n\r\n    /*---- 玩家装备 ----*/\r\n    equipments: {\r\n      head: {},\r\n      body: {},\r\n      hand: {},\r\n      foot: {},\r\n      weapon: {}\r\n    },\r\n\r\n    /*---- 技能 ----*/\r\n    skills: [],\r\n\r\n    /*---- 资源 ----*/\r\n    res: {\r\n      space: {\r\n        max: 30,\r\n        current: 0\r\n      },\r\n      lists: [\r\n        /*{\r\n         id:0,\r\n         count:12\r\n       }*/\r\n      ]\r\n    },\r\n\r\n    //对应任务的类型，是否需要收集物品，是否需要击杀指定数量的monster，\r\n    tasks: {\r\n      lists: {\r\n        /*0: {\r\n          type: 1,\r\n          monsters: [{id:1,count:1},{id:2,count:1}],\r\n          res: [{id:1,count:10}]\r\n        }*/\r\n      },\r\n      //已完成的任务列表\r\n      result: []\r\n    },\r\n\r\n    //是否死亡了\r\n    isDie: false\r\n  }\r\n}\r\n\r\n//----- Role -----//\r\n\r\n//重设玩家的初始值\r\nfunction resetRoleProperty(attributes) {\r\n  util.each(attributes, (attr) => {\r\n    attr._intrinsic = 0;\r\n    attr._intrinsic += attr.intrinsic;\r\n    //技能药物 增益\r\n    util.each(attr.gains, (gainItem) => {\r\n      attr._intrinsic += Math.round(attr._intrinsic * gainItem.gain);\r\n    });\r\n  });\r\n}\r\n\r\n//重新计算玩家所有的属性值\r\nexport function updateRoleProperty() {\r\n\r\n  const attributes = this.property.attributes;\r\n\r\n  //重设玩家的初始值\r\n  resetRoleProperty(attributes);\r\n\r\n  /*依赖装备属性计算*/\r\n  util.each(this.equipments, (equipment) => {\r\n    if (util.nullPlainObject(equipment)) return;\r\n    const property = equipment.property;\r\n    util.each(attributes, (attr, key) => {\r\n      attr._intrinsic += property[key]._intrinsic || 0;\r\n    });\r\n  });\r\n\r\n  //扣除伤害\r\n  util.each(attributes, (attr, key) => {\r\n    if (key === 'hp' || key === 'mp') {\r\n      attr.total = attr._intrinsic;\r\n      if (attr.total + attr.wasting < 0) {\r\n        attr.wasting = -attr.total;\r\n      }\r\n      attr._intrinsic += attr.wasting;\r\n    }\r\n  });\r\n\r\n  updateDieStatus.call(this);\r\n\r\n}\r\n\r\n//更新isDie状态\r\nfunction updateDieStatus() {\r\n  const hp = this.property.attributes.hp;\r\n  this.isDie = (hp.total + hp.wasting === 0);\r\n}\r\n\r\n//----- Role End -----//\r\n\r\n//----- Task -----//\r\n\r\n//更新任务monster累计\r\nfunction updateTaskMonster(opts) {\r\n  if (opts.monster) {\r\n    ++opts.monster.count;\r\n  }\r\n}\r\n\r\n//更新任务res累计\r\nfunction updateTaskRes(opts) {\r\n  if (opts.res) {\r\n    opts.res.count = opts.count;\r\n  }\r\n}\r\n\r\n//更新任务状态\r\nexport function updateTaskStatus(opts) {\r\n\r\n  //all tasks\r\n  const allTasks = this.$game.getTasks(),\r\n    //role tasks\r\n    roleTasks = this.tasks.lists;\r\n\r\n  //遍历用户任务\r\n  util.each(roleTasks, (roleTask, taskId) => {\r\n\r\n    const roleTaskRes = roleTask.res,         //查看当前任务res所需\r\n      roleTaskMonsters = roleTask.monsters,   //查看当前任务monster所需\r\n      currentTask = allTasks[taskId];         //当前任务列表中的任务\r\n\r\n    switch (currentTask.type) {\r\n      case 1:\r\n        //跑腿任务直接跳下一个任务状态\r\n        currentTask.status = 2;\r\n        break;\r\n      case 2:\r\n        //击杀 &| 收集任务\r\n        let resStatus = true,\r\n          monsterStatus = true;\r\n\r\n        //检查res是否符合任务要求\r\n        util.each(roleTaskRes, (res) => {\r\n\r\n          //这里的任务所需的资源id\r\n          const resId = res.id,\r\n            //从角色查找对应的id的物品详情\r\n            findRoleRes = findSameRes.apply(this, [res, true, false]);\r\n\r\n          /* 用户没有这个资源，直接跳出 */\r\n          if (findRoleRes.res.length === 0) {\r\n            resStatus = false;\r\n            return;\r\n          }\r\n\r\n          //更新任务中的资源数量\r\n          updateTaskRes.call(this, {\r\n            res,\r\n            count: findRoleRes.count\r\n          });\r\n\r\n          //用户资源 <= 任务资源\r\n          if (findRoleRes.count < currentTask.getTaskResCount(resId)) {\r\n            resStatus = false;\r\n          }\r\n\r\n        });\r\n\r\n        //检查monster是否符合任务要求\r\n        util.each(roleTaskMonsters, (monster) => {\r\n\r\n          const monsterId = monster.id;\r\n\r\n          //如果存在monster id 更新monster击杀数，往下将更新任务状态\r\n          if (opts.monsterId == monsterId &&\r\n            monster.count < currentTask.getTaskMonstersCount(monsterId)) {\r\n            updateTaskMonster.call(this, { monster });\r\n          }\r\n          //用户击杀 < 任务怪物击杀总数\r\n          if (monster.count < currentTask.getTaskMonstersCount(monsterId)) {\r\n            monsterStatus = false;\r\n          }\r\n        });\r\n\r\n        //改变当前任务状态\r\n        currentTask.status = (resStatus && monsterStatus) ? 2 : 1;\r\n        break;\r\n      default:\r\n        ;\r\n    }\r\n  });\r\n\r\n  //更新npc状态\r\n  updateNpcsTasksStatus.call(this);\r\n}\r\n\r\n//更新npc的任务状态\r\nfunction updateNpcsTasksStatus() {\r\n  const allNpcs = this.$game.getNpcs();\r\n\r\n  util.each(allNpcs, (npc) => {\r\n\r\n    const npcTasks = npc.getTasks();\r\n\r\n    //重新设置npc的r任务状态\r\n    npc.resetTaskStatus();\r\n\r\n    const taskStatus = npc.taskStatus;\r\n\r\n    util.each(npcTasks, (task) => {\r\n      //\"?\"存在未领取的任务，橙色\r\n      if (!taskStatus.hasTask\r\n        && task.status === 0) {\r\n        taskStatus.hasTask = true;\r\n      } else if (!taskStatus.hasUnfinishedTask\r\n        && task.status === 1) {\r\n        //\"?\"存在未完成的任务，灰色\r\n        taskStatus.hasUnfinishedTask = true;\r\n      } else if (!taskStatus.hasResultTask\r\n        && task.status === 2) {\r\n        //\"!\"存在完成未提交的任务任务，橙色\r\n        taskStatus.hasResultTask = true;\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\n//接受任务\r\nexport function receiveTask(task) {\r\n  const roleTasks = this.tasks.lists;\r\n  const Vue = this.$game.Vue;\r\n  if (roleTasks[task.id]) return false;\r\n  if (task.type === 1) {\r\n    roleTasks[task.id] = {};\r\n  } else if (task.type === 2) {\r\n\r\n    const taskDetails = task.details,\r\n      monsters = [],\r\n      res = [];\r\n\r\n    //初始化玩家任务怪物数据\r\n    util.each(taskDetails.monsters, (details) => {\r\n      monsters.push({\r\n        id: details.id,\r\n        count: 0,\r\n        taskCount: details.count\r\n      });\r\n    });\r\n\r\n    //初始化玩家任务资源数据\r\n    util.each(taskDetails.res, (details) => {\r\n      res.push({\r\n        id: details.id,\r\n        count: 0,\r\n        taskCount: details.count\r\n      });\r\n    });\r\n\r\n    const roleTask = {\r\n      monsters,\r\n      res\r\n    };\r\n\r\n    if (Vue) {\r\n      Vue.set(this.tasks.lists, task.id, roleTask);\r\n    } else {\r\n      roleTasks[task.id] = roleTask;\r\n    }\r\n  }\r\n\r\n  //更新任务状态\r\n  this.updateTaskStatus();\r\n}\r\n\r\n//任务依赖资源移除\r\nexport function removeRoleTaskRes(task) {\r\n  const taskRes = task.details.res;\r\n  util.each(taskRes, (res) => {\r\n    resRemove.apply(this, [res, res.count]);\r\n  });\r\n  this.updateResSpace();\r\n}\r\n\r\n//----- Task End -----//\r\n\r\n\r\n//----- Res -----//\r\n\r\n// role buy res\r\nexport function buy(res, amount) {\r\n\r\n  const game = this.$game,\r\n    allRes = game.getRes(),\r\n    property = this.property,\r\n    currency = property.currency,\r\n    goodsPrice = parseFloat((res.price * amount).toFixed());\r\n\r\n  if (currency < goodsPrice) return false;\r\n\r\n  //够钱买东西\r\n  property.currency -= goodsPrice;\r\n\r\n  resCapacity.apply(this, [res, amount, allRes[res.id].capacity]);\r\n\r\n}\r\n\r\n//是否有多余背包的空间\r\nexport function hasResSpace() {\r\n  const roleRes = this.res,\r\n    game = this.$game,\r\n    len = updateResSpace.call(this);  //顺便更新一下背包数量\r\n  if (len < roleRes.space.max) {\r\n    return true;\r\n  }\r\n  game.gameResources.res.hooks.notResSpace.call(game);\r\n  return false;\r\n}\r\n\r\n//更新用户的背包可用数\r\nexport function updateResSpace() {\r\n  const len = this.res.lists.length;\r\n  this.res.space.current = len;\r\n  return len;\r\n}\r\n\r\n//更新分配资源\r\nfunction updateRewardRes(res) {\r\n\r\n  /* 没有背包空间 */\r\n  if (!hasResSpace.call(this)) return false;\r\n\r\n  //游戏加载的资源\r\n  const game = this.$game,\r\n    allRes = game.getRes();\r\n\r\n  util.each(res, (_res) => {\r\n\r\n    //从自身去找对应的物品\r\n    const currentRes = allRes[_res.id];\r\n\r\n    //没有配置的资源直接跳出\r\n    if (!currentRes) return;\r\n\r\n    resCapacity.apply(this, [util.extend(currentRes, _res), _res.count, currentRes.capacity]);\r\n\r\n  });\r\n  this.updateResSpace();\r\n}\r\n\r\n//资源容量分配\r\nexport function resCapacity(res, count, capacity) {\r\n\r\n  const { Equipment } = game.constructor.Engine;\r\n\r\n  res = util.deepCopy(res);\r\n\r\n  if (res.type === 2) {\r\n    while (count--) {\r\n      res.id += `-${getRandomId()}`;\r\n      this.res.lists.push(Equipment.updateEquipment(res));\r\n    }\r\n  } else {\r\n\r\n    const getRes = findSameRes.call(this, res);\r\n\r\n    let _count = count;\r\n\r\n    for (let i = 0; i < getRes.length; i++) {\r\n      const _res = getRes[i];\r\n      if (_res.count === capacity) {\r\n        continue;\r\n      } else if (_res.count + _count > capacity) {\r\n        _count -= (capacity - _res.count);\r\n        _res.count = capacity;\r\n      } else {\r\n        _res.count += _count;\r\n        _count = 0;\r\n      }\r\n    }\r\n\r\n    if (_count > 0) {\r\n      this.res.lists.push({\r\n        id: res.id,\r\n        count: 0,\r\n        isBinding: res.isBinding\r\n      });\r\n      resCapacity.apply(this, [res, _count, capacity]);\r\n    }\r\n  }\r\n}\r\n\r\n//查找同一个物品在自身背包\r\nexport function findSameRes(res, isGetCount = false, checkBinding = true) {\r\n  const findRes = [];\r\n  let count = 0;\r\n  if (res.type === 2) return findRes;\r\n  this.res.lists.forEach((_res) => {\r\n    //检查id的同时，检查看是否为绑定的\r\n    if ((_res.id == res.id) && (checkBinding ? !!(_res.isBinding) == res.isBinding : true)) {\r\n      findRes.push(_res);\r\n      count += _res.count;\r\n    }\r\n  });\r\n  if (isGetCount) {\r\n    return {\r\n      res: findRes,\r\n      count\r\n    };\r\n  }\r\n  return findRes;\r\n}\r\n\r\n//获取随机的id,为了区分装备类查找的相同性\r\nfunction getRandomId() {\r\n  const time = new Date(),\r\n    randomNumber = (Math.random() * 1000).toFixed(0);\r\n  return `${time.getTime()}:${randomNumber}`;\r\n}\r\n\r\n//资源的移除\r\nexport function resRemove(res, count) {\r\n  const roleAllRes = this.res.lists;\r\n  const roleRes = this.findSameRes(res, false, false);\r\n  for (let i = 0; i < roleRes.length; i++) {\r\n    const _res = roleRes[i],\r\n      index = roleAllRes.indexOf(_res);\r\n    //如果当前的资源不够相抵，下一个资源抵扣\r\n    if (count - _res.count >= 0) {\r\n      roleAllRes.splice(index, 1);\r\n      count -= _res.count;\r\n    } else if (count - _res.count < 0) {\r\n      _res.count -= count;\r\n    }\r\n  }\r\n}\r\n\r\n//----- Res End -----//\r\n\r\n//----- Skill -----//\r\n\r\n//足够的技能消耗\r\n//@return {Boolean}\r\nexport function isAdequateSkillConsume(skill) {\r\n  const attributes = this.property.attributes,\r\n    { hp: skillHp, mp: skillMp } = skill.consume,\r\n    { hp, mp } = attributes;\r\n  if (hp._intrinsic - skillHp > 0 && mp._intrinsic - skillMp >= 0) {\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\n//升级->提升特性\r\nfunction advanceProperty() {\r\n  const property = this.property,\r\n    attributes = property.attributes;\r\n\r\n  /* 特性的属性 */\r\n  util.each(attributes, (attr) => {\r\n    const intrinsic = attr.intrinsic;\r\n    attr.intrinsic = Math.round(intrinsic + (intrinsic * 0.2));\r\n  });\r\n}\r\n\r\n//查找增益效果\r\nfunction findGain(gains, type, id) {\r\n  let i = 0;\r\n  for (; i < gains.length; i++) {\r\n    const gain = gains[i];\r\n    if (gain.type === type && gain.id === id) {\r\n      return i;\r\n    }\r\n  }\r\n  return -1;\r\n}\r\n\r\n//hp || mp || exp 效果处理\r\nfunction recover(recover, effect, name) {\r\n  if (name === 'hp' || name === 'mp') {\r\n    if (recover.wasting === 0) return;\r\n    if ((effect += recover.wasting) > 0) {\r\n      recover.wasting = 0;\r\n    } else {\r\n      recover.wasting = effect;\r\n    }\r\n  } else if (name === 'exp') {\r\n    updateLevel.call(this, effect);\r\n  }\r\n  this.updateRoleProperty();\r\n}\r\n\r\n//使用技能\r\nexport function useSkill(skill, isCounterattack) {\r\n\r\n  //扣除技能的消耗\r\n  deductSkillConsume.call(this, skill);\r\n\r\n  const roleAttributes = this.property.attributes,\r\n    current = this.current,\r\n    fight = current.fight,\r\n    enemy = fight.enemy,\r\n    id = skill.id;\r\n\r\n  //敌方是否已经阵亡\r\n  if (enemy.isDie) return;\r\n\r\n  // 攻击的状态，只能攻击一次，\r\n  // 针对的是物理攻击还是魔法攻击的，\r\n  // 设定用户的技能的时候只能设置一个，\r\n  // 不然攻击可能是物理的，可能是魔法的\r\n  let skillStatus = true;\r\n\r\n  //check attack name\r\n  const attackName = (function () {\r\n    const PHYSICAL_ATTACK_NAME = 'physicalAttack',\r\n      MAGIC_ATTACK_NAME = 'magicAttack';\r\n    const magicAttack = skill.property[MAGIC_ATTACK_NAME];\r\n    if (magicAttack.effect !== 0) {\r\n      return MAGIC_ATTACK_NAME;\r\n    } else {\r\n      return PHYSICAL_ATTACK_NAME;\r\n    }\r\n  })();\r\n\r\n  //use skill\r\n  util.each(skill.property, (skillAttributes, name) => {\r\n\r\n    if (skillAttributes.gain !== 0) {\r\n      setGain(this, skillAttributes, roleAttributes, 'skill', name, id);\r\n    }\r\n\r\n    if ((name === 'hp' || name === 'mp') &&\r\n      skillAttributes.effect !== 0) {\r\n      recover.call(this, roleAttributes[name], skillAttributes.effect, name);\r\n    } else if ((name === attackName) && skillStatus) {\r\n      isCounterattack = attack(this, fight.enemy, skillAttributes.effect, name, isCounterattack);\r\n      skillStatus = false;\r\n    }\r\n\r\n  });\r\n\r\n  //enemy attack role\r\n  if (isCounterattack) {\r\n    enemy.skill(enemy.getSkills()[0], false);\r\n  }\r\n}\r\n\r\n//扣除技能的消耗\r\nfunction deductSkillConsume(skill) {\r\n  const attributes = this.property.attributes,\r\n    { hp: skillHp, mp: skillMp } = skill.consume,\r\n    { hp, mp } = attributes;\r\n  hp.wasting += -skillHp;\r\n  mp.wasting += -skillMp;\r\n}\r\n\r\n//攻击\r\nfunction attack(role, enemy, effect, name, isCounterattack) {\r\n  const roleAttributes = role.property.attributes,\r\n    enemyAttributes = enemy.property.attributes,\r\n    rolePhysicalAttack = roleAttributes.physicalAttack,\r\n    roleSpellAttack = roleAttributes.magicAttack,\r\n    enemyPhysicalDefense = enemyAttributes.physicalDefense,\r\n    enemySpellDefense = enemyAttributes.magicDefense;\r\n  if (name === 'physicalAttack') {\r\n    return hurt(role, enemy, effect, rolePhysicalAttack, enemyPhysicalDefense, isCounterattack);\r\n  } else if (name === 'magicAttack') {\r\n    return hurt(role, enemy, effect, roleSpellAttack, enemySpellDefense, isCounterattack);\r\n  }\r\n}\r\n\r\n//攻击伤害\r\nfunction hurt(role, enemy, effect, attack, defense, isCounterattack) {\r\n  const game = role.$game,\r\n    enemyAttributes = enemy.property.attributes,\r\n    enemyHp = enemyAttributes.hp,\r\n    attackIntrinsic = attack._intrinsic,\r\n    defenseIntrinsic = defense._intrinsic;\r\n\r\n  //@hooks fight hurt\r\n  //return hurt\r\n  let enemyHarm = game.gameResources.skills.hooks.hurt.apply(game, [attackIntrinsic, effect, defenseIntrinsic]);\r\n\r\n  //没有伤害，直接扣1血\r\n  if (enemyHarm < 0) {\r\n    enemyHarm = 1;\r\n  }\r\n\r\n  if (enemyHarm >= enemyHp._intrinsic) {\r\n    role.current.fight.enemyHarm = -(enemyHp.total + enemyHp.wasting);\r\n    enemyHp.wasting = -enemyHp.total;\r\n    die(role, enemy);\r\n    isCounterattack = false;\r\n  } else {\r\n    role.current.fight.enemyHarm = -enemyHarm;\r\n    enemyHp.wasting += -enemyHarm;\r\n  }\r\n\r\n  enemy.updateRoleProperty();\r\n\r\n  return isCounterattack;\r\n}\r\n\r\n//战斗阵亡\r\n//role 战斗中的攻击角色\r\n//enemy 敌对\r\nfunction die(role, enemy) {\r\n  const game = enemy.$game,\r\n    my = game.my,\r\n    monstersHook = game.gameResources.monsters.hooks,\r\n    roleHook = game.gameResources.roles.hooks,\r\n    currentRole = my.role;  //当前的玩家\r\n\r\n  //玩家被击杀了\r\n  if (currentRole === enemy) {\r\n    //角色被击杀钩子，（被杀，杀）\r\n    roleHook.die.call(game, {\r\n      role: currentRole,\r\n      enemy: role\r\n    });\r\n  } else if (enemy.isMonster) {\r\n    //野怪被击杀了,添加野怪奖励\r\n    updateReward.apply(currentRole, [\r\n      enemy.reward.exp,\r\n      enemy.reward.currency,\r\n      enemy.reward.res\r\n    ]);\r\n    currentRole.updateTaskStatus({\r\n      monsterId: enemy.id\r\n    });\r\n    //怪物被击杀钩子\r\n    monstersHook.die.call(game, {\r\n      enemy,\r\n      role: currentRole\r\n    });\r\n  } else {\r\n    /*这里是其他玩家被击杀*/\r\n  }\r\n}\r\n\r\n//----- Skill End -----//\r\n\r\n//----- Level -----//\r\n\r\n//更新等级\r\nfunction updateLevel(exp) {\r\n  while (exp) {\r\n    const property = this.property,\r\n      roleExp = property.exp,\r\n      diffExp = roleExp.levelUp - roleExp.current;\r\n    if (exp === diffExp || diffExp === 0) {\r\n      roleExp.current = exp = 0;\r\n      ++property.level;\r\n      updateLevelUpExp.call(this);\r\n    } else if (exp > diffExp) {\r\n      roleExp.current = 0;\r\n      exp -= diffExp;\r\n      ++property.level;\r\n      updateLevelUpExp.call(this);\r\n    } else if (exp < diffExp) {\r\n      roleExp.current += exp;\r\n      exp = 0;\r\n    }\r\n  }\r\n\r\n  //初始化玩家属性\r\n  this.updateRoleProperty();\r\n}\r\n\r\n//更新升级后所需的经验\r\nfunction updateLevelUpExp() {\r\n  const game = this.$game,\r\n    property = this.property,\r\n    { hp, mp } = property.attributes,\r\n    level = property.level;\r\n\r\n  //更新等级升级所需\r\n  property.exp.levelUp = level * level * 150;\r\n\r\n  //hp和mp消耗初始化\r\n  hp.wasting = mp.wasting = 0;\r\n\r\n  //@hooks level up\r\n  game.gameResources.roles.hooks.levelUp.apply(game);\r\n\r\n  //提升属性\r\n  advanceProperty.call(this);\r\n}\r\n\r\n//----- Level End -----//\r\n\r\n//更新奖励\r\nexport function updateReward(exp, currency, res) {\r\n  updateLevel.call(this, exp);\r\n  updateCurrency.call(this, currency);\r\n  updateRewardRes.call(this, res);\r\n}\r\n\r\n//更新分配金币\r\nfunction updateCurrency(currency) {\r\n  this.property.currency += currency;\r\n}\r\n\r\n//使用消耗品\r\nexport function useConsumable(roleRes) {\r\n  const game = this.$game,\r\n    roleAttributes = this.property.attributes,\r\n    id = roleRes.id,\r\n    index = this.res.lists.indexOf(roleRes),\r\n    consumable = game.getRes(id);\r\n\r\n  if (!roleRes) return false;\r\n  if (roleRes.count > 0) --roleRes.count;\r\n  if (roleRes.count === 0) this.res.lists.splice(index, 1);\r\n\r\n  //消耗品的增益 && 消耗品恢复值\r\n  util.each(consumable.property, (consumableAttributes, name) => {\r\n    if (consumableAttributes.gain !== 0 &&\r\n      consumableAttributes.time !== 0) {\r\n      setGain(this, consumableAttributes, roleAttributes, 'consumable', name, id);\r\n    }\r\n    if (consumableAttributes.effect != null) {\r\n      if ((name === 'hp' ||\r\n          name === 'mp' ||\r\n          name === 'exp')\r\n        && consumableAttributes.effect !== 0) {\r\n        recover.call(this, roleAttributes[name], consumableAttributes.effect, name);\r\n      }\r\n    }\r\n  });\r\n  return true;\r\n}\r\n\r\n//增益处理\r\nfunction setGain(my, gainAttributes, roleAttributes, type, name, id) {\r\n  //增益列表\r\n  const gains = roleAttributes[name].gains;\r\n  let findIndex;\r\n  if ((findIndex = findGain(gains, type, id)) !== -1) {\r\n\r\n    //药物增益延长时间\r\n    if (type === 'consumable') {\r\n      gains[findIndex].time += gainAttributes.time;\r\n      return;\r\n    }\r\n\r\n    //原来增益的定时器清除\r\n    clearTimeout(gains[findIndex].timer);\r\n\r\n    //移除增益\r\n    gains.splice(findIndex, 1);\r\n  }\r\n\r\n  let newGain = {\r\n    id,\r\n    name,\r\n    type: type,\r\n    gain: gainAttributes.gain,\r\n    time: gainAttributes.time,\r\n    timer: setTimeout(timer.bind(my), 1000)\r\n  };\r\n\r\n  function timer() {\r\n    if (--newGain.time > 0) {\r\n      newGain.timer = setTimeout(timer.bind(my), 1000);\r\n    } else {\r\n      clearTimeout(newGain.timer);\r\n      newGain = null;\r\n      //移除增益\r\n      gains.splice(findGain(gains, type, id), 1);\r\n      my.updateRoleProperty();\r\n    }\r\n  }\r\n\r\n  gains.push(newGain);\r\n  my.updateRoleProperty();\r\n}\r\n\r\n//强化装备\r\nexport function strengthen(equipment) {\r\n  const game = this.$game,\r\n    { Equipment } = game.constructor.Engine,\r\n    strengthenRes = game.findStrengthenRes(equipment); //找到所需的强化物品\r\n\r\n  for (let i = 0; i < strengthenRes.length; i++) {\r\n    const _strengthenRes = strengthenRes[i],\r\n      quantity = _strengthenRes.quantity,\r\n      findRes = this.findSameRes(_strengthenRes, true, false);\r\n    if (findRes.count < quantity) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  //移除强化所需物资\r\n  strengthenRes.forEach((res) => {\r\n    resRemove.call(this, res, res.quantity);\r\n  });\r\n\r\n  ++equipment.strengthen;\r\n\r\n  Equipment.updateEquipment(equipment);\r\n\r\n  return true;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/engine/role/methods.js","/*\r\n* 怪物 类\r\n* */\r\nimport util from '@util';\r\nimport Role from '../index';\r\nimport { getConfig } from './methods';\r\n\r\nlet uid = 1;\r\n\r\nclass Monster extends Role {\r\n  constructor(opts = {}) {\r\n    super(util.extend(getConfig(), opts));\r\n    init.call(this);\r\n  }\r\n}\r\n\r\nfunction init() {\r\n\r\n  this.$map(this, this.$options);\r\n\r\n  this.id = (this.id || uid++);\r\n\r\n  delete this.$options;\r\n}\r\n\r\nexport default Monster;\n\n\n// WEBPACK FOOTER //\n// ./src/core/engine/role/monster/index.js","export function getConfig() {\r\n  return {\r\n    isMonster: true,\r\n    property: {\r\n      exp: false,\r\n      currency: false\r\n    },\r\n    reward: {           //奖励\r\n      exp: 0,           //完成后的经验\r\n      currency: 0,       //完成后的货币\r\n      res: [\r\n        /*{\r\n          id:1,\r\n          count:1\r\n        }*/\r\n      ]             //完成后的资源 uid{count:0} uid + 数量\r\n    },\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/engine/role/monster/methods.js","/*\r\n* npc类\r\n* */\r\nimport { getConfig } from './methods';\r\nimport util from '@util';\r\nimport Engine from '../index';\r\n\r\nlet uid = 1;\r\n\r\nclass Npc extends Engine {\r\n\r\n  constructor(opts = {}) {\r\n    super();\r\n    this.$options = util.extend(getConfig(), opts);\r\n    init.call(this);\r\n  }\r\n\r\n  //获取当前任务（可领取 && 在进行）\r\n  getTasks() {\r\n    const game = this.$game,     //game 实例\r\n      tasks = game.getTasks(),         //所有的任务\r\n      my = game.my.role,\r\n      level = my.level,       //用户等级\r\n      tasked = my.tasks.result;    //获取当前用户\r\n\r\n    const _tasks = [];\r\n\r\n    util.each(this.tasks, (taskId) => {\r\n\r\n      const task = tasks[taskId],           //当前任务\r\n        prevTask = task.prevTasks;  //上一级关联任务\r\n\r\n      //做过的任务 && level不够\r\n      if (tasked.indexOf(taskId) !== -1 || task.level > level) return;\r\n\r\n      //从已完成的任务列表中查找任务依赖\r\n      //任务依赖中存在\r\n      if (prevTask) {\r\n        if (tasked.indexOf(prevTask) !== -1) {\r\n          _tasks.push(task);\r\n        }\r\n      } else {\r\n        _tasks.push(task);\r\n      }\r\n    });\r\n\r\n    return _tasks;\r\n  }\r\n\r\n  //获取资源\r\n  getRes() {\r\n    const allRes = this.$game.getRes();\r\n    return util.each(this.res, (resUid) => {\r\n      return allRes[resUid];\r\n    }, true);\r\n  }\r\n\r\n  //清除npc状态\r\n  resetTaskStatus() {\r\n    this.taskStatus = {\r\n      hasTask: false,           //存在未领取的任务\r\n      hasUnfinishedTask: false, //存在未完成的任务\r\n      hasResultTask: false      //存在完成的任务\r\n    };\r\n  }\r\n}\r\n\r\nfunction init() {\r\n  this.$map(this, this.$options);\r\n  this.id = (this.id || uid++);\r\n  delete this.$options;\r\n}\r\n\r\nexport default Npc;\n\n\n// WEBPACK FOOTER //\n// ./src/core/engine/npc/index.js","/*\r\n* npc方法\r\n* */\r\n\r\nexport function getConfig() {\r\n  return {\r\n    name: '',             //名字\r\n    description: '',      //npc描述\r\n    res: [],              //资源\r\n    tasks: [],            //任务\r\n    taskStatus: {          //任务状态\r\n      hasTask: false,           //存在未领取的任务\r\n      hasUnfinishedTask: false, //存在未完成的任务\r\n      hasResultTask: false      //存在完成的任务\r\n    },\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/engine/npc/methods.js","/*\r\n* 装备类\r\n* */\r\nimport { getConfig } from './methods';\r\nimport util from '@util';\r\nimport Engine from '../index';\r\n\r\nlet uid = 1;\r\n\r\n//任务\r\nclass Task extends Engine {\r\n  constructor(opts = {}) {\r\n    super();\r\n    this.$options = util.extend(getConfig(), opts);\r\n    init.call(this);\r\n  }\r\n\r\n  //获取任务id中资源count\r\n  getTaskResCount(id) {\r\n    const taskRes = this.details.res;\r\n    for (var i = 0; i < taskRes.length; i++) {\r\n      const res = taskRes[i];\r\n      if (res.id == id) {\r\n        return res.count;\r\n      }\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  //获取任务id中击杀count\r\n  getTaskMonstersCount(id) {\r\n    const taskMonsters = this.details.monsters;\r\n    for (var i = 0; i < taskMonsters.length; i++) {\r\n      const monster = taskMonsters[i];\r\n      if (monster.id == id) {\r\n        return monster.count;\r\n      }\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  //获取任务资源\r\n  getRewardRes() {\r\n    const game = this.$game,\r\n      allRes = game.getRes();\r\n    return util.each(this.reward.res, (taskRes) => {\r\n      const id = taskRes.id,\r\n        res = allRes[id],\r\n        currentRes = util.deepCopy(res);\r\n\r\n      let _res = {};\r\n\r\n      //针对装备类直接扩展到原来的装备\r\n      if (res.type === 2) {\r\n        _res = {\r\n          res: util.extend(currentRes, taskRes),\r\n          count: 1\r\n        };\r\n      } else {\r\n        _res = {\r\n          res,\r\n          count: taskRes.count\r\n        };\r\n      }\r\n      return _res;\r\n    }, true);\r\n  }\r\n\r\n}\r\n\r\nfunction init() {\r\n  this.$map(this, this.$options);\r\n  this.id = (this.id || uid++);\r\n  delete this.$options;\r\n}\r\n\r\nexport default Task;\n\n\n// WEBPACK FOOTER //\n// ./src/core/engine/task/index.js","/*\r\n* 任务方法\r\n* */\r\n\r\n/*\r\n* 任务名  @name {String}\r\n* 任务描述  @description {String}\r\n* 任务归类  @classify {Number}  1:主线 2.支线 3.每日任务\r\n* 任务类型  @type {Number}  1:跑腿 2.击杀&|购买物品\r\n* 任务状态  @status {Number}  0:未领取 1:已领取未完成 2:完成，未提交 3：完成，提交\r\n* 任务状态  @level {Number}  等级限制\r\n* 任务奖励  @reward {Object}\r\n*    @exp {Number} 奖励经验\r\n*    @currency {Number} 奖励货币\r\n*    @res {Array}    奖励物资\r\n* */\r\n\r\nexport function getConfig() {\r\n  return {\r\n    name: '',           //任务名\r\n    classify: 1,        //任务归类\r\n    level: 1,           //等级限制\r\n    status: 0,          //任务状态，完成将会添加到用户已完成的列表中，\r\n\r\n    //任务状态描述内容\r\n    description: {\r\n      notReceivedTask: \"\",              //未领取任务描述\r\n      unfinishedTask: \"\",               //未完成的任务描述\r\n      resultTask: \"\"                    //完成任务后的描述\r\n    },\r\n\r\n    type: 1,                            //任务类型\r\n\r\n    details: {                          //任务细节\r\n      res: [\r\n        /*{\r\n          id:1,\r\n          count:10\r\n        }*/\r\n      ],                       //所需任务资源\r\n      monsters: [\r\n        /*{\r\n          id:1,\r\n          count:1\r\n        }*/\r\n      ]//所需任务击杀怪物\r\n    },\r\n    reward: {           //奖励\r\n      exp: 0,           //完成后的经验\r\n      currency: 0,       //完成后的货币\r\n      res: [\r\n        /*{\r\n          id:1,\r\n          count:1\r\n        }*/\r\n      ]             //完成后的资源 uid{count:0} uid + 数量\r\n    },\r\n    prevTasks: null        //上一个关联任务  currentTaskId : prevTaskId\r\n  };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/engine/task/methods.js","/*\r\n* 装备类\r\n* */\r\nimport { getConfig, updateEquipment } from './methods';\r\nimport util from '@util';\r\nimport Res from '../index';\r\n\r\n//Equipment extends Res\r\nclass Equipment extends Res {\r\n  constructor(opts = {}) {\r\n    super(util.extend(getConfig(), opts));\r\n    init.call(this);\r\n  }\r\n\r\n  updateEquipment(){\r\n    return updateEquipment(this);\r\n  }\r\n}\r\n\r\nfunction init() {\r\n  this.$map(this, this.$options);\r\n  this.updateEquipment();\r\n  delete this.$options;\r\n}\r\n\r\nEquipment.updateEquipment = updateEquipment;\r\n\r\nexport default Equipment;\n\n\n// WEBPACK FOOTER //\n// ./src/core/engine/res/equipment/index.js","/*\r\n* 装备方法\r\n* */\r\n\r\nimport util from '@util';\r\n\r\n//get equipment config\r\nexport function getConfig() {\r\n  return {\r\n    classify: null,     //装备分类 head,hand,body,foot,weapon\r\n    type: 2,            //武器类型\r\n    quality: 1,         //品质\r\n    property: {\r\n      hp: {\r\n        intrinsic: 0,\r\n        _intrinsic: 0\r\n      },\r\n      mp: {\r\n        intrinsic: 0,\r\n        _intrinsic: 0\r\n      },\r\n      physicalAttack: {\r\n        intrinsic: 0,\r\n        _intrinsic: 0\r\n      },\r\n      physicalDefense: {\r\n        intrinsic: 0,\r\n        _intrinsic: 0\r\n      },\r\n      magicAttack: {\r\n        intrinsic: 0,\r\n        _intrinsic: 0\r\n      },\r\n      magicDefense: {\r\n        intrinsic: 0,\r\n        _intrinsic: 0\r\n      }\r\n    },\r\n    strengthen: 0,         //强化\r\n    count: 1,            //默认数量1(不建议修改)\r\n    isEquip: false        //是否装备了\r\n  }\r\n}\r\n\r\n//update equipment property\r\nexport function updateEquipment(equipment) {\r\n  const property = equipment.property;\r\n  util.each(property, (_property) => {\r\n    _property._intrinsic = (_property.intrinsic + _property.intrinsic * (equipment.strengthen * 0.01));\r\n  });\r\n  return equipment;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/engine/res/equipment/methods.js","/*\r\n* 消耗类\r\n* */\r\nimport { getConfig } from './methods';\r\nimport util from '@util';\r\nimport Res from '../index';\r\n\r\n//消耗 继承 资源\r\nclass Consumable extends Res {\r\n  constructor(opts = {}) {\r\n    super(util.extend(getConfig(), opts));\r\n    init.call(this);\r\n  }\r\n}\r\n\r\nfunction init() {\r\n  this.$map(this, this.$options);\r\n  delete this.$options;\r\n}\r\n\r\nexport default Consumable;\n\n\n// WEBPACK FOOTER //\n// ./src/core/engine/res/consumable/index.js","/*\r\n* 消耗品方法\r\n* */\r\n\r\nexport function getConfig() {\r\n  return {\r\n    name: '',           //消耗品\r\n    description: '',    //消耗描述\r\n    type: 3,            //类型\r\n    hasUse:false,      //是否存在增益效果\r\n    property: {\r\n      hp: {\r\n        gain: 0,      //增益\r\n        effect: 0,     //效果\r\n        time: null,   //增益的有限时间\r\n        timer: null   //增益的定时器\r\n      },\r\n      mp: {\r\n        gain: 0,\r\n        effect: 0,\r\n        time: null,\r\n        timer: null\r\n      },\r\n      exp: {\r\n        gain: 0,\r\n        effect: 0,\r\n        time: null,\r\n        timer: null\r\n      },\r\n      physicalAttack: {\r\n        gain: 0,\r\n        time: null,\r\n        timer: null\r\n      },\r\n      physicalDefense: {\r\n        gain: 0,\r\n        time: null,\r\n        timer: null\r\n      },\r\n      magicAttack: {\r\n        gain: 0,\r\n        time: null,\r\n        timer: null\r\n      },\r\n      magicDefense: {\r\n        gain: 0,\r\n        time: null,\r\n        timer: null\r\n      }\r\n    }\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/engine/res/consumable/methods.js","/*\r\n* 装备类\r\n* */\r\nimport { getConfig } from './methods';\r\nimport util from '@util';\r\nimport Res from '../index';\r\n\r\n//强化 继承 资源\r\nclass Strengthen extends Res {\r\n  constructor(opts = {}) {\r\n    super(util.extend(getConfig(), opts));\r\n    init.call(this);\r\n  }\r\n}\r\n\r\nfunction init() {\r\n  this.$map(this, this.$options);\r\n  delete this.$options;\r\n}\r\n\r\nexport default Strengthen;\n\n\n// WEBPACK FOOTER //\n// ./src/core/engine/res/strengthen/index.js","/*\r\n* 消耗品方法\r\n* */\r\n\r\nexport function getConfig() {\r\n  return {\r\n    strengthen: 99,     //强化要求提升等级\r\n    type: 4,            //类型\r\n    quantity: 5,        //强化所需数量\r\n    isStrengthen: true  //强化物品类型\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/engine/res/strengthen/methods.js"],"sourceRoot":""}