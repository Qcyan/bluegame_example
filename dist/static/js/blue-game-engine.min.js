/*!
 * 
 * blue-game-engine.js 1.0.0
 * (c) 2016-2017 Blue
 * Released under the MIT License.
 * https://github.com/azhanging/blue-game-engine
 * time:Sun, 15 Jul 2018 10:38:11 GMT
 * 		
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.BlueGame=e():t.BlueGame=e()}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="./static",n(n.s=5)}([function(t,e,n){"use strict";var r=n(8),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var s=new(function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r["a"]),i(e,[{key:"nullPlainObject",value:function(t){return"{}"===JSON.stringify(t)}},{key:"isStr",value:function(t){return"string"==typeof t}},{key:"isPlainObject",value:function(t){return t&&null!==t&&"[object Object]"===t.toString()}},{key:"isArray",value:function(t){return t instanceof Array}},{key:"isObjcet",value:function(t){return this.isPlainObject(t)||this.isArray(t)}},{key:"isDef",value:function(t){return void 0!==t&&null!==t}},{key:"isUndef",value:function(t){return void 0===t||null===t}},{key:"isBlankSpace",value:function(t){return 0===t.trim().length}},{key:"isTrue",value:function(t){return!0===t}},{key:"isFalse",value:function(t){return!1===t}},{key:"run",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];e.apply(t,n)}},{key:"each",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isUndef(t)){var r=0,i=0,s=[],o=t.length;if(this.isArray(t))for(;r<o;r++)n?s.push(e(t[r],r)):e(t[r],r);else for(r in t)t.hasOwnProperty(r)&&(n?s.push(e(t[r],r,i++)):e(t[r],r,i++));return n?s:void 0}}},{key:"definePropertyVal",value:function(t,e,n){Object.defineProperty(t,e,{configurable:!1,enumerable:!1,value:n})}},{key:"deepCopy",value:function(t){if(!t||!(t instanceof Array)&&"[object Object]"!==t.toString())return t;var e=t instanceof Array?[]:{};for(var n in t)t.hasOwnProperty(n)&&(t instanceof Array||t instanceof Object?e[n]=this.deepCopy(t[n]):e[n]=t[n]);return e}},{key:"extend",value:function(t,e){var n=this;t=this.deepCopy(t);var r=this.each(t,function(t,e){return e},!0);return this.each(e,function(e,i){var s=r.indexOf(i);-1!=s&&r.splice(s,1),n.isPlainObject(e)&&(t[i]||(t[i]={}),n.extend(t[i],e)),t[i]=e}),this.each(r,function(n){e[n]=t[n]}),t}},{key:"copy",value:function(t,e){s.each(e,function(e,n){t[n]=e})}},{key:"getRegExp",value:function(t){return this.each("\\/*.?+$^[](){}|'\"",function(e,n){t=t.replace(new RegExp("\\"+e,"g"),"\\"+e)}),t}},{key:"getObjLen",value:function(t){var e=0;return this.each(t,function(){++e}),e}}]),e}());e.a=s},function(t,e,n){"use strict";var r=n(3);var i=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r["a"]),e}();e.a=i},function(t,e,n){"use strict";var r=n(14),i=n(0),s=n(1);var o=1,a=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.$options=i.a.extend(Object(r.a)(),t),function(){this.$map(this,this.$options),this.id=this.id||o++,delete this.$options}.call(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s["a"]),e}();e.a=a},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return r(t,[{key:"$property",value:function(t,e,n){t[e]=n}},{key:"$map",value:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}}]),t}();e.a=i},function(t,e,n){"use strict";var r=n(0),i=n(1),s=n(17),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var a=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.$options=r.a.extend(Object(s.c)(),t),function(){this.$map(this,this.$options),delete this.$options,this.updateRoleProperty(),this.updateResSpace(),this.clearFight()}.call(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i["a"]),o(e,[{key:"getRes",value:function(t){var e=this,n=this.$game.getRes(),i=this.res.lists;if(t){for(var s=0;s<i.length;s++){var o=i[s],a=n[t];if(o.id===t)return 2===o.type?{res:o,roleRes:o}:{res:a,roleRes:this.findSameRes(o)}}return{res:null,roleRes:{}}}return r.a.each(i,function(t,r){var i=t.id.toString().split("-")[0],s=n[i];return 2===s.type?e.getRes(t.id):{res:s,roleRes:t}},!0)}},{key:"findSameRes",value:function(t,e,n){return s.b.apply(this,[t,e,n])}},{key:"getSkills",value:function(t){var e=this,n=this.$game.getSkills();if(t){var i=n[t];return i&&i.level<=this.property.level?i:{}}var s=[];return r.a.each(this.skills,function(t){var r=n[t];!r||r.level>e.property.level||s.push(r)}),s}},{key:"getTasks",value:function(){var t=this.$game.getTasks();return r.a.each(this.tasks.lists,function(e,n){return t[n]},!0)}},{key:"getTaskMonstersCount",value:function(t,e){var n=this.tasks.lists[t];if(!n)return 0;for(var r=n.monsters,i=0;i<r.length;i++){var s=r[i];if(e==s.id)return s.count}}},{key:"updateTaskStatus",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{monsterId:0};s.l.call(this,t)}},{key:"receiveTask",value:function(t){var e=this.$game;return s.f.call(this,t),e.gameResources.tasks.hooks.receiveTask.call(e,{task:t}),this}},{key:"cancelTask",value:function(t){var e=this.tasks.lists,n=this.$game;if(!e[t.id])return!1;delete e[t.id],t.status=0,this.updateTaskStatus(),n.gameResources.tasks.hooks.cancelTask.call(n,{task:t})}},{key:"submitTask",value:function(t){if(2!==t.status)return!1;var e=t.reward,n=this.$game;t.status=3,s.g.call(this,t),this.tasks.result.push(t.id),delete this.tasks.lists[t.id],s.j.apply(this,[e.exp,e.currency,e.res]),this.updateTaskStatus(),n.gameResources.tasks.hooks.submitTask.call(n,{task:t})}},{key:"updateRoleProperty",value:function(){s.k.call(this)}},{key:"equip",value:function(t){if(!s.d.call(this))return!1;var e=this.res.lists,n=this.$game,i=this.equipments,o=i[t.classify];if(!t.classify&&2!==t.type)return!1;r.a.nullPlainObject(o)||this.disboard(o),i[t.classify]=t;var a=e.indexOf(t);return e.splice(a,1),t.isEquip=!0,this.updateRoleProperty(),this.updateResSpace(),n.gameResources.res.hooks.equip.call(n,{res:t}),!0}},{key:"disboard",value:function(t){var e=this.$game;return!!s.d.call(this)&&(this.equipments[t.classify]={},this.res.lists.push(t),t.isEquip=!1,this.updateRoleProperty(),this.updateResSpace(),e.gameResources.res.hooks.disboard.call(e,{res:t}),!0)}},{key:"skill",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t.$game;return!!s.e.call(this,t)&&(s.n.apply(this,[t,e]),this.updateRoleProperty(),n.gameResources.skills.hooks.use.call(n,{skill:t}),!0)}},{key:"consumable",value:function(t){var e=this.$game,n=s.m.call(this,t);return this.updateRoleProperty(),this.updateTaskStatus(),this.updateResSpace(),e.gameResources.res.hooks.consumable.call(e,{res:t}),n}},{key:"updateResSpace",value:function(){s.i.call(this)}},{key:"buy",value:function(t,e){return!!s.d.call(this)&&(s.a.apply(this,[t,e]),this.updateTaskStatus(),this.updateResSpace(),!0)}},{key:"discard",value:function(t,e){var n=this.res.lists,r=n.indexOf(t);2===t.type?n.splice(r,1):(t.count-=e,t.count<1&&n.splice(r,1)),this.updateResSpace()}},{key:"strengthen",value:function(t){return s.h.call(this,t)}},{key:"fight",value:function(t){if(this.isDie)return!1;var e=this.$game.constructor.Engine.Monster,n=this.current.fight;t&&t.isMonster?(n.enemy=new e(r.a.deepCopy(t)),n.enemyHarm=0,n.enemy.current.fight.enemy=this,n.enemy.current.fight.enemyHarm=0,n.enemy.updateRoleProperty()):t&&!t.isMonster&&(n.enemy=t,t.updateRoleProperty())}},{key:"clearFight",value:function(){var t=this.current.fight;t.enemy=null,t.enemyHarm=0}},{key:"dieRecover",value:function(t){var e=this.property.attributes;e.hp.wasting=-e.hp.total*(1-t),this.updateRoleProperty()}}]),e}();e.a=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(6),i=n(7),s=n(1),o=n(12),a=n(2),u=n(15),c=n(4),l=n(18),f=n(20),p=n(22),h=n(24),y=n(26),v=n(28);i.a.Engine=s.a,s.a.Map=o.a,s.a.Npc=f.a,s.a.Res=a.a,s.a.Skill=u.a,s.a.Role=c.a,s.a.Monster=l.a,s.a.Equipment=h.a,s.a.Consumable=y.a,s.a.Strengthen=v.a,s.a.Task=p.a,Object(r.a)(),e.default=i.a},function(t,e,n){"use strict";e.a=function(){0}},function(t,e,n){"use strict";var r=n(0),i=n(3),s=n(9),o=n(10),a=n(11),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var l=!1,f=null,p=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=c(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.constructor!==e?c(n,new e(t)):l?c(n,f):(l=!0,f=n,function(t){Object.defineProperty(i.a.prototype,"$game",{enumerable:!1,value:this}),this.$options=r.a.extend(Object(o.a)(),t),a.c.call(this),a.a.call(this),a.d.call(this),a.e.call(this),a.b.call(this),delete this.$options}.call(n,t),n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i["a"]),u(e,[{key:"goMap",value:function(t){o.b.call(this,t),o.c.call(this),this.my.role&&this.my.role.updateTaskStatus(),this.gameResources.maps.hooks.goMap.call(this,{map:this.getMaps()[t]})}},{key:"getMaps",value:function(t){var e=this.gameResources.maps.lists;return t?e[t]||null:e}},{key:"getNpcs",value:function(t){var e=this.gameResources.npcs.lists;return t?e[e]||null:e}},{key:"getRes",value:function(t){var e=this.gameResources.res.lists;return t?e[t]||null:e}},{key:"getTasks",value:function(t){var e=this.gameResources.tasks.lists;return t?e[t]||null:e}},{key:"getSkills",value:function(t){var e=this.gameResources.skills.lists;return t?e[t]||null:e}},{key:"getMonsters",value:function(t){var e=this.gameResources.monsters.lists;return t?e[t]||null:e}},{key:"setVueInstance",value:function(t){this.$vm=t}},{key:"addMyRole",value:function(t){this.my.allRoles.push(t)}},{key:"setCurrentRole",value:function(t){this.my.role=t}},{key:"findStrengthenRes",value:function(t){for(var e=t.strengthen,n=this.gameResources.res.upgrade.strengthen.rules,r=[],i=0;i<n.length;i++){var s=n[i];s.strengthen>e&&r.push(s.res)}return r[r.length-1]||[]}}]),e}();p.local=p.prototype.local=new s.a({type:"local"}),p.session=p.prototype.session=new s.a({type:"session"}),e.a=p},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return r(t,[{key:"outerHTML",value:function(t){return t.outerHTML}},{key:"getElm",value:function(t){return document.querySelector(t)}},{key:"createElement",value:function(t){return document.createElement(t)}},{key:"createTextNode",value:function(t){return document.createTextNode(t)}},{key:"createComment",value:function(t){return document.createComment(t)}},{key:"textContent",value:function(t,e){t.textContent=e}},{key:"insertBefore",value:function(t,e,n){t.insertBefore(e,n)}},{key:"nextSibling",value:function(t){return t.nextSibling}},{key:"parent",value:function(t){return t&&t.parentNode||null}},{key:"remove",value:function(t){t.remove()}},{key:"setAttribute",value:function(t,e,n){t.setAttribute(e,n)}},{key:"removeAttribute",value:function(t,e){t.removeAttribute(e)}}]),t}();e.a=i},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$options=e,function(){var t=this.$options.type;this.storage=window[t+"Storage"]||localStorage}.call(this)}return r(t,[{key:"getItem",value:function(t){return this.storage.getItem(t)}},{key:"setItem",value:function(t,e){return this.storage.setItem(t,e),this}},{key:"removeItem",value:function(t){return this.storage.removeItem(t),this}},{key:"key",value:function(t){return this.storage.key(t)}},{key:"clear",value:function(){this.storage.clear()}}]),t}();e.a=i},function(t,e,n){"use strict";e.a=function(){return{config:{},current:{map:null,npcs:[]},my:{role:null,allRoles:[],hooks:{}},gameResources:{roles:{lists:[],hooks:{die:function(t){},levelUp:function(){}}},monsters:{lists:{},hooks:{die:function(t){}}},maps:{lists:{},hooks:{goMap:function(t){}}},skills:{lists:{},hooks:{hurt:function(t,e,n){return Math.floor(t+t*e-(1*Math.random()*n+n))},use:function(t){}}},npcs:{lists:{},hooks:{}},res:{lists:{},upgrade:{strengthen:{rules:[]},inlay:{}},hooks:{equip:function(t){},disboard:function(t){},consumable:function(t){},notResSpace:function(t){}}},tasks:{lists:{},hooks:{receiveTask:function(t){},cancelTask:function(t){},submitTask:function(t){}}}},Vue:null,$vm:null}},e.b=function(t){this.current.map=this.gameResources.maps.lists[t||1],this.my.role&&(this.my.role.current.map=t||1)},e.c=function(){var t=this.current,e=t.map;t.npcs=e?t.map.getNpcs():[]}},function(t,e,n){"use strict";e.c=function(){this.$map(this,this.$options)},e.a=function(){var t=this,e=this.$options;r.a.each(e.gameResources.tasks.lists,function(e){for(var n=[],r=0;r<e.details.res.length;r++){var i=e.details.res[r],s=t.getRes(i.id);2!==s.type&&n.push(i)}e.details.res=n})},e.b=function(){var t=this.constructor.Engine.Role,e=this.$options;this.my.role=e.my.role?new t(e.my.role):null},e.d=function(){r.a.each(this.gameResources.skills.lists,function(t){r.a.each(t.property,function(e){t.hasGain||0!==e.gain&&(t.hasGain=!0)})})},e.e=function(){var t=this.getRes(),e={},n=[],i=this.gameResources.res.upgrade.strengthen;r.a.each(t,function(t){if(t.isStrengthen){var n=t.strengthen;e[n]||(e[n]=[]),e[n].push(t)}});var s=Object.keys(e).sort(function(t,e){return t>e});r.a.each(s,function(t){var r=e[t];n.push({strengthen:parseInt(t),res:r})}),i.rules=n};var r=n(0)},function(t,e,n){"use strict";var r=n(13),i=n(0),s=n(1),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var a=1,u=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.$options=i.a.extend(Object(r.a)(),t),function(){this.$map(this,this.$options),this.id=this.id||a++,delete this.$options}.call(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s["a"]),o(e,[{key:"getMaps",value:function(){var t=this.$game.getMaps();return i.a.each(this.maps,function(e){return t[e]},!0)}},{key:"getNpcs",value:function(){var t=this.$game.getNpcs();return i.a.each(this.npcs,function(e){return t[e]},!0)}},{key:"getMonsters",value:function(){var t=this.$game.getMonsters();return i.a.each(this.monsters,function(e){return t[e]},!0)}}]),e}();e.a=u},function(t,e,n){"use strict";e.a=function(){return{name:"",description:"",players:[],npcs:[],maps:[],monsters:[]}}},function(t,e,n){"use strict";e.a=function(){return{name:"",description:"",type:1,price:0,capacity:99,isBinding:!1}}},function(t,e,n){"use strict";var r=n(0),i=n(16),s=n(1);var o=1,a=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.$options=r.a.extend(Object(i.a)(),t),function(){this.$map(this,this.$options),this.id=this.id||o++,delete this.$options}.call(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s["a"]),e}();e.a=a},function(t,e,n){"use strict";e.a=function(){return{name:"",description:"",level:1,hasGain:!1,property:{hp:{gain:0,effect:0,time:null,timer:null},mp:{gain:0,effect:0,time:null,timer:null},physicalAttack:{gain:0,effect:0,time:null,timer:null},physicalDefense:{gain:0,time:null,timer:null},magicAttack:{gain:0,effect:0,time:null,timer:null},magicDefense:{gain:0,time:null,timer:null}},consume:{hp:0,mp:0}}}},function(t,e,n){"use strict";e.c=function(){return{id:0,name:"",type:0,occupation:"",current:{fight:{enemy:null,enemyHarm:0},map:null},property:{exp:{levelUp:150,current:0},attributes:{hp:{intrinsic:120,_intrinsic:0,total:0,wasting:0,gains:[]},mp:{intrinsic:72,_intrinsic:0,total:0,wasting:0,gains:[]},physicalAttack:{intrinsic:30,_intrinsic:0,gains:[]},physicalDefense:{intrinsic:15,_intrinsic:0,gains:[]},magicAttack:{intrinsic:20,_intrinsic:0,gains:[]},magicDefense:{intrinsic:20,_intrinsic:0,gains:[]}},currency:0,level:1},description:"",equipments:{head:{},body:{},hand:{},foot:{},weapon:{}},skills:[],res:{space:{max:30,current:0},lists:[]},tasks:{lists:{},result:[]},isDie:!1}},e.k=function(){var t=this.property.attributes;(function(t){r.a.each(t,function(t){t._intrinsic=0,t._intrinsic+=t.intrinsic,r.a.each(t.gains,function(e){t._intrinsic+=Math.round(t._intrinsic*e.gain)})})})(t),r.a.each(this.equipments,function(e){if(!r.a.nullPlainObject(e)){var n=e.property;r.a.each(t,function(t,e){t._intrinsic+=n[e]._intrinsic||0})}}),r.a.each(t,function(t,e){"hp"!==e&&"mp"!==e||(t.total=t._intrinsic,t.total+t.wasting<0&&(t.wasting=-t.total),t._intrinsic+=t.wasting)}),function(){var t=this.property.attributes.hp;this.isDie=t.total+t.wasting===0}.call(this)},e.l=function(t){var e=this,n=this.$game.getTasks(),i=this.tasks.lists;r.a.each(i,function(i,s){var o=i.res,u=i.monsters,c=n[s];switch(c.type){case 1:c.status=2;break;case 2:var l=!0,f=!0;r.a.each(o,function(t){var n=t.id,r=a.apply(e,[t,!0,!1]);0!==r.res.length?(function(t){t.res&&(t.res.count=t.count)}.call(e,{res:t,count:r.count}),r.count<c.getTaskResCount(n)&&(l=!1)):l=!1}),r.a.each(u,function(n){var r=n.id;t.monsterId==r&&n.count<c.getTaskMonstersCount(r)&&function(t){t.monster&&++t.monster.count}.call(e,{monster:n}),n.count<c.getTaskMonstersCount(r)&&(f=!1)}),c.status=l&&f?2:1}}),function(){var t=this.$game.getNpcs();r.a.each(t,function(t){var e=t.getTasks();t.resetTaskStatus();var n=t.taskStatus;r.a.each(e,function(t){n.hasTask||0!==t.status?n.hasUnfinishedTask||1!==t.status?n.hasResultTask||2!==t.status||(n.hasResultTask=!0):n.hasUnfinishedTask=!0:n.hasTask=!0})})}.call(this)},e.f=function(t){var e=this.tasks.lists,n=this.$game.Vue;if(e[t.id])return!1;if(1===t.type)e[t.id]={};else if(2===t.type){var i=t.details,s=[],o=[];r.a.each(i.monsters,function(t){s.push({id:t.id,count:0,taskCount:t.count})}),r.a.each(i.res,function(t){o.push({id:t.id,count:0,taskCount:t.count})});var a={monsters:s,res:o};n?n.set(this.tasks.lists,t.id,a):e[t.id]=a}this.updateTaskStatus()},e.g=function(t){var e=this,n=t.details.res;r.a.each(n,function(t){u.apply(e,[t,t.count])}),this.updateResSpace()},e.a=function(t,e){var n=this.$game.getRes(),r=this.property,i=r.currency,s=parseFloat((t.price*e).toFixed());if(i<s)return!1;r.currency-=s,o.apply(this,[t,e,n[t.id].capacity])},e.d=i,e.i=s,e.b=a,e.e=function(t){var e=this.property.attributes,n=t.consume,r=n.hp,i=n.mp,s=e.hp,o=e.mp;if(s._intrinsic-r>0&&o._intrinsic-i>=0)return!0;return!1},e.n=function(t,e){var n=this;(function(t){var e=this.property.attributes,n=t.consume,r=n.hp,i=n.mp,s=e.hp,o=e.mp;s.wasting+=-r,o.wasting+=-i}).call(this,t);var i=this.property.attributes,s=this.current.fight,o=s.enemy,a=t.id;if(o.isDie)return;var u=!0,c=(p=t.property.magicAttack,0!==p.effect?"magicAttack":"physicalAttack");var p;r.a.each(t.property,function(t,r){0!==t.gain&&v(n,t,i,"skill",r,a),"hp"!==r&&"mp"!==r||0===t.effect?r===c&&u&&(e=function(t,e,n,r,i){var s=t.property.attributes,o=e.property.attributes,a=s.physicalAttack,u=s.magicAttack,c=o.physicalDefense,l=o.magicDefense;return"physicalAttack"===r?f(t,e,n,a,c,i):"magicAttack"===r?f(t,e,n,u,l,i):void 0}(n,s.enemy,t.effect,r,e),u=!1):l.call(n,i[r],t.effect,r)}),e&&o.skill(o.getSkills()[0],!1)},e.j=y,e.m=function(t){var e=this,n=this.$game,i=this.property.attributes,s=t.id,o=this.res.lists.indexOf(t),a=n.getRes(s);if(!t)return!1;t.count>0&&--t.count;0===t.count&&this.res.lists.splice(o,1);return r.a.each(a.property,function(t,n){0!==t.gain&&0!==t.time&&v(e,t,i,"consumable",n,s),null!=t.effect&&("hp"!==n&&"mp"!==n&&"exp"!==n||0===t.effect||l.call(e,i[n],t.effect,n))}),!0},e.h=function(t){for(var e=this,n=this.$game,r=n.constructor.Engine.Equipment,i=n.findStrengthenRes(t),s=0;s<i.length;s++){var o=i[s],a=o.quantity,c=this.findSameRes(o,!0,!1);if(c.count<a)return!1}return i.forEach(function(t){u.call(e,t,t.quantity)}),++t.strengthen,r.updateEquipment(t),!0};var r=n(0);function i(){var t=this.res,e=this.$game;return s.call(this)<t.space.max||(e.gameResources.res.hooks.notResSpace.call(e),!1)}function s(){var t=this.res.lists.length;return this.res.space.current=t,t}function o(t,e,n){var i,s,u=game.constructor.Engine.Equipment;if(2===(t=r.a.deepCopy(t)).type)for(;e--;)t.id+="-"+(i=void 0,void 0,i=new Date,s=(1e3*Math.random()).toFixed(0),i.getTime()+":"+s),this.res.lists.push(u.updateEquipment(t));else{for(var c=a.call(this,t),l=e,f=0;f<c.length;f++){var p=c[f];p.count!==n&&(p.count+l>n?(l-=n-p.count,p.count=n):(p.count+=l,l=0))}l>0&&(this.res.lists.push({id:t.id,count:0,isBinding:t.isBinding}),o.apply(this,[t,l,n]))}}function a(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[],i=0;return 2===t.type?r:(this.res.lists.forEach(function(e){e.id!=t.id||n&&!!e.isBinding!=t.isBinding||(r.push(e),i+=e.count)}),e?{res:r,count:i}:r)}function u(t,e){for(var n=this.res.lists,r=this.findSameRes(t,!1,!1),i=0;i<r.length;i++){var s=r[i],o=n.indexOf(s);e-s.count>=0?(n.splice(o,1),e-=s.count):e-s.count<0&&(s.count-=e)}}function c(t,e,n){for(var r=0;r<t.length;r++){var i=t[r];if(i.type===e&&i.id===n)return r}return-1}function l(t,e,n){if("hp"===n||"mp"===n){if(0===t.wasting)return;(e+=t.wasting)>0?t.wasting=0:t.wasting=e}else"exp"===n&&p.call(this,e);this.updateRoleProperty()}function f(t,e,n,r,i,s){var o=t.$game,a=e.property.attributes.hp,u=r._intrinsic,c=i._intrinsic,l=o.gameResources.skills.hooks.hurt.apply(o,[u,n,c]);return l<0&&(l=1),l>=a._intrinsic?(t.current.fight.enemyHarm=-(a.total+a.wasting),a.wasting=-a.total,function(t,e){var n=e.$game,r=n.my,i=n.gameResources.monsters.hooks,s=n.gameResources.roles.hooks,o=r.role;o===e?s.die.call(n,{role:o,enemy:t}):e.isMonster&&(y.apply(o,[e.reward.exp,e.reward.currency,e.reward.res]),o.updateTaskStatus({monsterId:e.id}),i.die.call(n,{enemy:e,role:o}))}(t,e),s=!1):(t.current.fight.enemyHarm=-l,a.wasting+=-l),e.updateRoleProperty(),s}function p(t){for(;t;){var e=this.property,n=e.exp,r=n.levelUp-n.current;t===r||0===r?(n.current=t=0,++e.level,h.call(this)):t>r?(n.current=0,t-=r,++e.level,h.call(this)):t<r&&(n.current+=t,t=0)}this.updateRoleProperty()}function h(){var t=this.$game,e=this.property,n=e.attributes,i=n.hp,s=n.mp,o=e.level;e.exp.levelUp=o*o*150,i.wasting=s.wasting=0,t.gameResources.roles.hooks.levelUp.apply(t),function(){var t=this.property.attributes;r.a.each(t,function(t){var e=t.intrinsic;t.intrinsic=Math.round(e+.2*e)})}.call(this)}function y(t,e,n){p.call(this,t),function(t){this.property.currency+=t}.call(this,e),function(t){var e=this;if(!i.call(this))return!1;var n=this.$game.getRes();r.a.each(t,function(t){var i=n[t.id];i&&o.apply(e,[r.a.extend(i,t),t.count,i.capacity])}),this.updateResSpace()}.call(this,n)}function v(t,e,n,r,i,s){var o,a=n[i].gains;if(-1!==(o=c(a,r,s))){if("consumable"===r)return void(a[o].time+=e.time);clearTimeout(a[o].timer),a.splice(o,1)}var u={id:s,name:i,type:r,gain:e.gain,time:e.time,timer:setTimeout(function e(){--u.time>0?u.timer=setTimeout(e.bind(t),1e3):(clearTimeout(u.timer),u=null,a.splice(c(a,r,s),1),t.updateRoleProperty())}.bind(t),1e3)};a.push(u),t.updateRoleProperty()}},function(t,e,n){"use strict";var r=n(0),i=n(4),s=n(19);var o=1,a=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r.a.extend(Object(s.a)(),t)));return function(){this.$map(this,this.$options),this.id=this.id||o++,delete this.$options}.call(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i["a"]),e}();e.a=a},function(t,e,n){"use strict";e.a=function(){return{isMonster:!0,property:{exp:!1,currency:!1},reward:{exp:0,currency:0,res:[]}}}},function(t,e,n){"use strict";var r=n(21),i=n(0),s=n(1),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var a=1,u=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.$options=i.a.extend(Object(r.a)(),t),function(){this.$map(this,this.$options),this.id=this.id||a++,delete this.$options}.call(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s["a"]),o(e,[{key:"getTasks",value:function(){var t=this.$game,e=t.getTasks(),n=t.my.role,r=n.level,s=n.tasks.result,o=[];return i.a.each(this.tasks,function(t){var n=e[t],i=n.prevTasks;-1!==s.indexOf(t)||n.level>r||(i?-1!==s.indexOf(i)&&o.push(n):o.push(n))}),o}},{key:"getRes",value:function(){var t=this.$game.getRes();return i.a.each(this.res,function(e){return t[e]},!0)}},{key:"resetTaskStatus",value:function(){this.taskStatus={hasTask:!1,hasUnfinishedTask:!1,hasResultTask:!1}}}]),e}();e.a=u},function(t,e,n){"use strict";e.a=function(){return{name:"",description:"",res:[],tasks:[],taskStatus:{hasTask:!1,hasUnfinishedTask:!1,hasResultTask:!1}}}},function(t,e,n){"use strict";var r=n(23),i=n(0),s=n(1),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var a=1,u=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.$options=i.a.extend(Object(r.a)(),t),function(){this.$map(this,this.$options),this.id=this.id||a++,delete this.$options}.call(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s["a"]),o(e,[{key:"getTaskResCount",value:function(t){for(var e=this.details.res,n=0;n<e.length;n++){var r=e[n];if(r.id==t)return r.count}return 0}},{key:"getTaskMonstersCount",value:function(t){for(var e=this.details.monsters,n=0;n<e.length;n++){var r=e[n];if(r.id==t)return r.count}return 0}},{key:"getRewardRes",value:function(){var t=this.$game.getRes();return i.a.each(this.reward.res,function(e){var n=e.id,r=t[n],s=i.a.deepCopy(r);return 2===r.type?{res:i.a.extend(s,e),count:1}:{res:r,count:e.count}},!0)}}]),e}();e.a=u},function(t,e,n){"use strict";e.a=function(){return{name:"",classify:1,level:1,status:0,description:{notReceivedTask:"",unfinishedTask:"",resultTask:""},type:1,details:{res:[],monsters:[]},reward:{exp:0,currency:0,res:[]},prevTasks:null}}},function(t,e,n){"use strict";var r=n(25),i=n(0),s=n(2),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var a=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,i.a.extend(Object(r.a)(),t)));return function(){this.$map(this,this.$options),this.updateEquipment(),delete this.$options}.call(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s["a"]),o(e,[{key:"updateEquipment",value:function(){return Object(r.b)(this)}}]),e}();a.updateEquipment=r.b,e.a=a},function(t,e,n){"use strict";e.a=function(){return{classify:null,type:2,quality:1,property:{hp:{intrinsic:0,_intrinsic:0},mp:{intrinsic:0,_intrinsic:0},physicalAttack:{intrinsic:0,_intrinsic:0},physicalDefense:{intrinsic:0,_intrinsic:0},magicAttack:{intrinsic:0,_intrinsic:0},magicDefense:{intrinsic:0,_intrinsic:0}},strengthen:0,count:1,isEquip:!1}},e.b=function(t){var e=t.property;return r.a.each(e,function(e){e._intrinsic=e.intrinsic+e.intrinsic*(.01*t.strengthen)}),t};var r=n(0)},function(t,e,n){"use strict";var r=n(27),i=n(0),s=n(2);var o=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,i.a.extend(Object(r.a)(),t)));return function(){this.$map(this,this.$options),delete this.$options}.call(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s["a"]),e}();e.a=o},function(t,e,n){"use strict";e.a=function(){return{name:"",description:"",type:3,hasUse:!1,property:{hp:{gain:0,effect:0,time:null,timer:null},mp:{gain:0,effect:0,time:null,timer:null},exp:{gain:0,effect:0,time:null,timer:null},physicalAttack:{gain:0,time:null,timer:null},physicalDefense:{gain:0,time:null,timer:null},magicAttack:{gain:0,time:null,timer:null},magicDefense:{gain:0,time:null,timer:null}}}}},function(t,e,n){"use strict";var r=n(29),i=n(0),s=n(2);var o=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,i.a.extend(Object(r.a)(),t)));return function(){this.$map(this,this.$options),delete this.$options}.call(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s["a"]),e}();e.a=o},function(t,e,n){"use strict";e.a=function(){return{strengthen:99,type:4,quantity:5,isStrengthen:!0}}}]).default});
//# sourceMappingURL=blue-game-engine.min.js.map